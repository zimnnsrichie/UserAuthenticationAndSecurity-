{
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\server.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\server.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\server.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\server.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
        "sourceFileName": "server.js"
      }
    },
    "ast": null,
    "code": "const app = require('./app');\n\nconst express = require('express');\n\nconst port = process.env.PORT || 3000;\n\nconst bodyParser = require('body-parser');\n\napp.use(bodyParser.urlencoded({\n  extended: true\n}));\napp.use(bodyParser.json());\n\nconst session = require('express-session');\n\napp.use(session({\n  secret: 'edurekaSecret',\n  resave: false,\n  saveUninitialized: true\n}));\napp.use(express.static(__dirname + '/public'));\napp.set('view engine', 'ejs');\napp.set('views', './views');\nlet sess;\napp.get('/admin', (req, res) => {\n  sess = req.session;\n  sess.email = \" \";\n  res.render('adminSignUp', {\n    invalid: req.query.invalid ? req.query.invalid : '',\n    msg: req.query.msg ? req.query.msg : ''\n  });\n});\napp.get('/', (req, res) => {\n  sess = req.session;\n  sess.email = \" \";\n  res.render('signin', {\n    invalid: req.query.invalid ? req.query.invalid : '',\n    msg: req.query.msg ? req.query.msg : ''\n  });\n});\nconst server = app.listen(port, () => {\n  console.log('Express server listening on port ' + port);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZlci5qcyJdLCJuYW1lcyI6WyJhcHAiLCJyZXF1aXJlIiwiZXhwcmVzcyIsInBvcnQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVCIsImJvZHlQYXJzZXIiLCJ1c2UiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJqc29uIiwic2Vzc2lvbiIsInNlY3JldCIsInJlc2F2ZSIsInNhdmVVbmluaXRpYWxpemVkIiwic3RhdGljIiwiX19kaXJuYW1lIiwic2V0Iiwic2VzcyIsImdldCIsInJlcSIsInJlcyIsImVtYWlsIiwicmVuZGVyIiwiaW52YWxpZCIsInF1ZXJ5IiwibXNnIiwic2VydmVyIiwibGlzdGVuIiwiY29uc29sZSIsImxvZyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsR0FBRyxHQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFuQjs7QUFDQSxNQUFNQyxPQUFPLEdBQUdELE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUVBLE1BQU1FLElBQUksR0FBR0MsT0FBTyxDQUFDQyxHQUFSLENBQVlDLElBQVosSUFBb0IsSUFBakM7O0FBRUEsTUFBTUMsVUFBVSxHQUFHTixPQUFPLENBQUMsYUFBRCxDQUExQjs7QUFDQUQsR0FBRyxDQUFDUSxHQUFKLENBQVFELFVBQVUsQ0FBQ0UsVUFBWCxDQUFzQjtBQUFFQyxFQUFBQSxRQUFRLEVBQUU7QUFBWixDQUF0QixDQUFSO0FBQ0FWLEdBQUcsQ0FBQ1EsR0FBSixDQUFRRCxVQUFVLENBQUNJLElBQVgsRUFBUjs7QUFFQSxNQUFNQyxPQUFPLEdBQUdYLE9BQU8sQ0FBQyxpQkFBRCxDQUF2Qjs7QUFDQUQsR0FBRyxDQUFDUSxHQUFKLENBQVFJLE9BQU8sQ0FBQztBQUNkQyxFQUFBQSxNQUFNLEVBQUUsZUFETTtBQUVkQyxFQUFBQSxNQUFNLEVBQUUsS0FGTTtBQUdkQyxFQUFBQSxpQkFBaUIsRUFBRTtBQUhMLENBQUQsQ0FBZjtBQU1BZixHQUFHLENBQUNRLEdBQUosQ0FBUU4sT0FBTyxDQUFDYyxNQUFSLENBQWVDLFNBQVMsR0FBRyxTQUEzQixDQUFSO0FBQ0FqQixHQUFHLENBQUNrQixHQUFKLENBQVEsYUFBUixFQUF1QixLQUF2QjtBQUNBbEIsR0FBRyxDQUFDa0IsR0FBSixDQUFRLE9BQVIsRUFBaUIsU0FBakI7QUFFQSxJQUFJQyxJQUFKO0FBRUFuQixHQUFHLENBQUNvQixHQUFKLENBQVEsUUFBUixFQUFrQixDQUFDQyxHQUFELEVBQU1DLEdBQU4sS0FBYztBQUM5QkgsRUFBQUEsSUFBSSxHQUFHRSxHQUFHLENBQUNULE9BQVg7QUFDQU8sRUFBQUEsSUFBSSxDQUFDSSxLQUFMLEdBQWEsR0FBYjtBQUVBRCxFQUFBQSxHQUFHLENBQUNFLE1BQUosQ0FBVyxhQUFYLEVBQ0U7QUFDRUMsSUFBQUEsT0FBTyxFQUFFSixHQUFHLENBQUNLLEtBQUosQ0FBVUQsT0FBVixHQUFvQkosR0FBRyxDQUFDSyxLQUFKLENBQVVELE9BQTlCLEdBQXdDLEVBRG5EO0FBRUVFLElBQUFBLEdBQUcsRUFBRU4sR0FBRyxDQUFDSyxLQUFKLENBQVVDLEdBQVYsR0FBZ0JOLEdBQUcsQ0FBQ0ssS0FBSixDQUFVQyxHQUExQixHQUFnQztBQUZ2QyxHQURGO0FBS0QsQ0FURDtBQVdBM0IsR0FBRyxDQUFDb0IsR0FBSixDQUFRLEdBQVIsRUFBYSxDQUFDQyxHQUFELEVBQU1DLEdBQU4sS0FBYztBQUN6QkgsRUFBQUEsSUFBSSxHQUFHRSxHQUFHLENBQUNULE9BQVg7QUFDQU8sRUFBQUEsSUFBSSxDQUFDSSxLQUFMLEdBQWEsR0FBYjtBQUVBRCxFQUFBQSxHQUFHLENBQUNFLE1BQUosQ0FBVyxRQUFYLEVBQ0U7QUFDRUMsSUFBQUEsT0FBTyxFQUFFSixHQUFHLENBQUNLLEtBQUosQ0FBVUQsT0FBVixHQUFvQkosR0FBRyxDQUFDSyxLQUFKLENBQVVELE9BQTlCLEdBQXdDLEVBRG5EO0FBRUVFLElBQUFBLEdBQUcsRUFBRU4sR0FBRyxDQUFDSyxLQUFKLENBQVVDLEdBQVYsR0FBZ0JOLEdBQUcsQ0FBQ0ssS0FBSixDQUFVQyxHQUExQixHQUFnQztBQUZ2QyxHQURGO0FBTUQsQ0FWRDtBQVlBLE1BQU1DLE1BQU0sR0FBRzVCLEdBQUcsQ0FBQzZCLE1BQUosQ0FBVzFCLElBQVgsRUFBaUIsTUFBTTtBQUNwQzJCLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHNDQUFzQzVCLElBQWxEO0FBQ0QsQ0FGYyxDQUFmIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcSzMwMDA0NFxccHJvamVjdHNcXFVzZXJBdXRoZW50aWNhdGlvbkFuZFNlY3VyaXR5XFwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBhcHAgPSByZXF1aXJlKCcuL2FwcCcpO1xyXG5jb25zdCBleHByZXNzID0gcmVxdWlyZSgnZXhwcmVzcycpO1xyXG5cclxuY29uc3QgcG9ydCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgMzAwMDtcclxuXHJcbmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xyXG5hcHAudXNlKGJvZHlQYXJzZXIudXJsZW5jb2RlZCh7IGV4dGVuZGVkOiB0cnVlIH0pKVxyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKVxyXG5cclxuY29uc3Qgc2Vzc2lvbiA9IHJlcXVpcmUoJ2V4cHJlc3Mtc2Vzc2lvbicpO1xyXG5hcHAudXNlKHNlc3Npb24oe1xyXG4gIHNlY3JldDogJ2VkdXJla2FTZWNyZXQnLFxyXG4gIHJlc2F2ZTogZmFsc2UsXHJcbiAgc2F2ZVVuaW5pdGlhbGl6ZWQ6IHRydWVcclxufSkpO1xyXG5cclxuYXBwLnVzZShleHByZXNzLnN0YXRpYyhfX2Rpcm5hbWUgKyAnL3B1YmxpYycpKTtcclxuYXBwLnNldCgndmlldyBlbmdpbmUnLCAnZWpzJyk7XHJcbmFwcC5zZXQoJ3ZpZXdzJywgJy4vdmlld3MnKTtcclxuXHJcbmxldCBzZXNzO1xyXG5cclxuYXBwLmdldCgnL2FkbWluJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgc2VzcyA9IHJlcS5zZXNzaW9uO1xyXG4gIHNlc3MuZW1haWwgPSBcIiBcIlxyXG5cclxuICByZXMucmVuZGVyKCdhZG1pblNpZ25VcCcsXHJcbiAgICB7XHJcbiAgICAgIGludmFsaWQ6IHJlcS5xdWVyeS5pbnZhbGlkID8gcmVxLnF1ZXJ5LmludmFsaWQgOiAnJyxcclxuICAgICAgbXNnOiByZXEucXVlcnkubXNnID8gcmVxLnF1ZXJ5Lm1zZyA6ICcnXHJcbiAgICB9KVxyXG59KVxyXG5cclxuYXBwLmdldCgnLycsIChyZXEsIHJlcykgPT4ge1xyXG4gIHNlc3MgPSByZXEuc2Vzc2lvbjtcclxuICBzZXNzLmVtYWlsID0gXCIgXCJcclxuXHJcbiAgcmVzLnJlbmRlcignc2lnbmluJyxcclxuICAgIHtcclxuICAgICAgaW52YWxpZDogcmVxLnF1ZXJ5LmludmFsaWQgPyByZXEucXVlcnkuaW52YWxpZCA6ICcnLFxyXG4gICAgICBtc2c6IHJlcS5xdWVyeS5tc2cgPyByZXEucXVlcnkubXNnIDogJydcclxuICAgIH0pXHJcblxyXG59KVxyXG5cclxuY29uc3Qgc2VydmVyID0gYXBwLmxpc3Rlbihwb3J0LCAoKSA9PiB7XHJcbiAgY29uc29sZS5sb2coJ0V4cHJlc3Mgc2VydmVyIGxpc3RlbmluZyBvbiBwb3J0ICcgKyBwb3J0KTtcclxufSk7Il19",
    "map": {
      "version": 3,
      "sources": [
        "server.js"
      ],
      "names": [
        "app",
        "require",
        "express",
        "port",
        "process",
        "env",
        "PORT",
        "bodyParser",
        "use",
        "urlencoded",
        "extended",
        "json",
        "session",
        "secret",
        "resave",
        "saveUninitialized",
        "static",
        "__dirname",
        "set",
        "sess",
        "get",
        "req",
        "res",
        "email",
        "render",
        "invalid",
        "query",
        "msg",
        "server",
        "listen",
        "console",
        "log"
      ],
      "mappings": "AAAA,MAAMA,GAAG,GAAGC,OAAO,CAAC,OAAD,CAAnB;;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAD,CAAvB;;AAEA,MAAME,IAAI,GAAGC,OAAO,CAACC,GAAR,CAAYC,IAAZ,IAAoB,IAAjC;;AAEA,MAAMC,UAAU,GAAGN,OAAO,CAAC,aAAD,CAA1B;;AACAD,GAAG,CAACQ,GAAJ,CAAQD,UAAU,CAACE,UAAX,CAAsB;AAAEC,EAAAA,QAAQ,EAAE;AAAZ,CAAtB,CAAR;AACAV,GAAG,CAACQ,GAAJ,CAAQD,UAAU,CAACI,IAAX,EAAR;;AAEA,MAAMC,OAAO,GAAGX,OAAO,CAAC,iBAAD,CAAvB;;AACAD,GAAG,CAACQ,GAAJ,CAAQI,OAAO,CAAC;AACdC,EAAAA,MAAM,EAAE,eADM;AAEdC,EAAAA,MAAM,EAAE,KAFM;AAGdC,EAAAA,iBAAiB,EAAE;AAHL,CAAD,CAAf;AAMAf,GAAG,CAACQ,GAAJ,CAAQN,OAAO,CAACc,MAAR,CAAeC,SAAS,GAAG,SAA3B,CAAR;AACAjB,GAAG,CAACkB,GAAJ,CAAQ,aAAR,EAAuB,KAAvB;AACAlB,GAAG,CAACkB,GAAJ,CAAQ,OAAR,EAAiB,SAAjB;AAEA,IAAIC,IAAJ;AAEAnB,GAAG,CAACoB,GAAJ,CAAQ,QAAR,EAAkB,CAACC,GAAD,EAAMC,GAAN,KAAc;AAC9BH,EAAAA,IAAI,GAAGE,GAAG,CAACT,OAAX;AACAO,EAAAA,IAAI,CAACI,KAAL,GAAa,GAAb;AAEAD,EAAAA,GAAG,CAACE,MAAJ,CAAW,aAAX,EACE;AACEC,IAAAA,OAAO,EAAEJ,GAAG,CAACK,KAAJ,CAAUD,OAAV,GAAoBJ,GAAG,CAACK,KAAJ,CAAUD,OAA9B,GAAwC,EADnD;AAEEE,IAAAA,GAAG,EAAEN,GAAG,CAACK,KAAJ,CAAUC,GAAV,GAAgBN,GAAG,CAACK,KAAJ,CAAUC,GAA1B,GAAgC;AAFvC,GADF;AAKD,CATD;AAWA3B,GAAG,CAACoB,GAAJ,CAAQ,GAAR,EAAa,CAACC,GAAD,EAAMC,GAAN,KAAc;AACzBH,EAAAA,IAAI,GAAGE,GAAG,CAACT,OAAX;AACAO,EAAAA,IAAI,CAACI,KAAL,GAAa,GAAb;AAEAD,EAAAA,GAAG,CAACE,MAAJ,CAAW,QAAX,EACE;AACEC,IAAAA,OAAO,EAAEJ,GAAG,CAACK,KAAJ,CAAUD,OAAV,GAAoBJ,GAAG,CAACK,KAAJ,CAAUD,OAA9B,GAAwC,EADnD;AAEEE,IAAAA,GAAG,EAAEN,GAAG,CAACK,KAAJ,CAAUC,GAAV,GAAgBN,GAAG,CAACK,KAAJ,CAAUC,GAA1B,GAAgC;AAFvC,GADF;AAMD,CAVD;AAYA,MAAMC,MAAM,GAAG5B,GAAG,CAAC6B,MAAJ,CAAW1B,IAAX,EAAiB,MAAM;AACpC2B,EAAAA,OAAO,CAACC,GAAR,CAAY,sCAAsC5B,IAAlD;AACD,CAFc,CAAf",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "sourcesContent": [
        "const app = require('./app');\r\nconst express = require('express');\r\n\r\nconst port = process.env.PORT || 3000;\r\n\r\nconst bodyParser = require('body-parser');\r\napp.use(bodyParser.urlencoded({ extended: true }))\r\napp.use(bodyParser.json())\r\n\r\nconst session = require('express-session');\r\napp.use(session({\r\n  secret: 'edurekaSecret',\r\n  resave: false,\r\n  saveUninitialized: true\r\n}));\r\n\r\napp.use(express.static(__dirname + '/public'));\r\napp.set('view engine', 'ejs');\r\napp.set('views', './views');\r\n\r\nlet sess;\r\n\r\napp.get('/admin', (req, res) => {\r\n  sess = req.session;\r\n  sess.email = \" \"\r\n\r\n  res.render('adminSignUp',\r\n    {\r\n      invalid: req.query.invalid ? req.query.invalid : '',\r\n      msg: req.query.msg ? req.query.msg : ''\r\n    })\r\n})\r\n\r\napp.get('/', (req, res) => {\r\n  sess = req.session;\r\n  sess.email = \" \"\r\n\r\n  res.render('signin',\r\n    {\r\n      invalid: req.query.invalid ? req.query.invalid : '',\r\n      msg: req.query.msg ? req.query.msg : ''\r\n    })\r\n\r\n})\r\n\r\nconst server = app.listen(port, () => {\r\n  console.log('Express server listening on port ' + port);\r\n});"
      ]
    },
    "sourceType": "module",
    "mtime": 1613919225875
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\app.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\app.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\app.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\app.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
        "sourceFileName": "app.js"
      }
    },
    "ast": null,
    "code": "const express = require('express');\n\nconst app = express();\n\nconst db = require('./db');\n\nconst UserController = require('./user/UserController');\n\napp.use('/users', UserController);\n\nconst AuthController = require('./auth/AuthController');\n\napp.use('/api/auth', AuthController);\n\nconst AdminController = require('./admin/AdminController');\n\napp.use('/admin', AdminController);\nmodule.exports = app;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsImFwcCIsImRiIiwiVXNlckNvbnRyb2xsZXIiLCJ1c2UiLCJBdXRoQ29udHJvbGxlciIsIkFkbWluQ29udHJvbGxlciIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLE9BQU8sR0FBR0MsT0FBTyxDQUFDLFNBQUQsQ0FBdkI7O0FBQ0EsTUFBTUMsR0FBRyxHQUFHRixPQUFPLEVBQW5COztBQUNBLE1BQU1HLEVBQUUsR0FBR0YsT0FBTyxDQUFDLE1BQUQsQ0FBbEI7O0FBRUEsTUFBTUcsY0FBYyxHQUFHSCxPQUFPLENBQUMsdUJBQUQsQ0FBOUI7O0FBQ0FDLEdBQUcsQ0FBQ0csR0FBSixDQUFRLFFBQVIsRUFBa0JELGNBQWxCOztBQUVBLE1BQU1FLGNBQWMsR0FBR0wsT0FBTyxDQUFDLHVCQUFELENBQTlCOztBQUNBQyxHQUFHLENBQUNHLEdBQUosQ0FBUSxXQUFSLEVBQXFCQyxjQUFyQjs7QUFFQSxNQUFNQyxlQUFlLEdBQUdOLE9BQU8sQ0FBQyx5QkFBRCxDQUEvQjs7QUFDQUMsR0FBRyxDQUFDRyxHQUFKLENBQVEsUUFBUixFQUFrQkUsZUFBbEI7QUFFQUMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCUCxHQUFqQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXEszMDAwNDRcXHByb2plY3RzXFxVc2VyQXV0aGVudGljYXRpb25BbmRTZWN1cml0eVxcIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xyXG5jb25zdCBkYiA9IHJlcXVpcmUoJy4vZGInKTtcclxuXHJcbmNvbnN0IFVzZXJDb250cm9sbGVyID0gcmVxdWlyZSgnLi91c2VyL1VzZXJDb250cm9sbGVyJyk7XHJcbmFwcC51c2UoJy91c2VycycsIFVzZXJDb250cm9sbGVyKTtcclxuXHJcbmNvbnN0IEF1dGhDb250cm9sbGVyID0gcmVxdWlyZSgnLi9hdXRoL0F1dGhDb250cm9sbGVyJyk7XHJcbmFwcC51c2UoJy9hcGkvYXV0aCcsIEF1dGhDb250cm9sbGVyKTtcclxuXHJcbmNvbnN0IEFkbWluQ29udHJvbGxlciA9IHJlcXVpcmUoJy4vYWRtaW4vQWRtaW5Db250cm9sbGVyJylcclxuYXBwLnVzZSgnL2FkbWluJywgQWRtaW5Db250cm9sbGVyKVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBhcHA7Il19",
    "map": {
      "version": 3,
      "sources": [
        "app.js"
      ],
      "names": [
        "express",
        "require",
        "app",
        "db",
        "UserController",
        "use",
        "AuthController",
        "AdminController",
        "module",
        "exports"
      ],
      "mappings": "AAAA,MAAMA,OAAO,GAAGC,OAAO,CAAC,SAAD,CAAvB;;AACA,MAAMC,GAAG,GAAGF,OAAO,EAAnB;;AACA,MAAMG,EAAE,GAAGF,OAAO,CAAC,MAAD,CAAlB;;AAEA,MAAMG,cAAc,GAAGH,OAAO,CAAC,uBAAD,CAA9B;;AACAC,GAAG,CAACG,GAAJ,CAAQ,QAAR,EAAkBD,cAAlB;;AAEA,MAAME,cAAc,GAAGL,OAAO,CAAC,uBAAD,CAA9B;;AACAC,GAAG,CAACG,GAAJ,CAAQ,WAAR,EAAqBC,cAArB;;AAEA,MAAMC,eAAe,GAAGN,OAAO,CAAC,yBAAD,CAA/B;;AACAC,GAAG,CAACG,GAAJ,CAAQ,QAAR,EAAkBE,eAAlB;AAEAC,MAAM,CAACC,OAAP,GAAiBP,GAAjB",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "sourcesContent": [
        "const express = require('express');\r\nconst app = express();\r\nconst db = require('./db');\r\n\r\nconst UserController = require('./user/UserController');\r\napp.use('/users', UserController);\r\n\r\nconst AuthController = require('./auth/AuthController');\r\napp.use('/api/auth', AuthController);\r\n\r\nconst AdminController = require('./admin/AdminController')\r\napp.use('/admin', AdminController)\r\n\r\nmodule.exports = app;"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918278553
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\db.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\db.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\db.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\db.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
        "sourceFileName": "db.js"
      }
    },
    "ast": null,
    "code": "const mongoose = require('mongoose');\n\nmongoose.connect('mongodb://127.0.0.1:27017/db_shopping_cart', {\n  useNewUrlParser: true\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsImNvbm5lY3QiLCJ1c2VOZXdVcmxQYXJzZXIiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBRUFELFFBQVEsQ0FBQ0UsT0FBVCxDQUFpQiw0Q0FBakIsRUFBK0Q7QUFBRUMsRUFBQUEsZUFBZSxFQUFFO0FBQW5CLENBQS9EIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcSzMwMDA0NFxccHJvamVjdHNcXFVzZXJBdXRoZW50aWNhdGlvbkFuZFNlY3VyaXR5XFwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtb25nb29zZSA9IHJlcXVpcmUoJ21vbmdvb3NlJyk7XHJcblxyXG5tb25nb29zZS5jb25uZWN0KCdtb25nb2RiOi8vMTI3LjAuMC4xOjI3MDE3L2RiX3Nob3BwaW5nX2NhcnQnLCB7IHVzZU5ld1VybFBhcnNlcjogdHJ1ZSB9KSJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "db.js"
      ],
      "names": [
        "mongoose",
        "require",
        "connect",
        "useNewUrlParser"
      ],
      "mappings": "AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AAEAD,QAAQ,CAACE,OAAT,CAAiB,4CAAjB,EAA+D;AAAEC,EAAAA,eAAe,EAAE;AAAnB,CAA/D",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "sourcesContent": [
        "const mongoose = require('mongoose');\r\n\r\nmongoose.connect('mongodb://127.0.0.1:27017/db_shopping_cart', { useNewUrlParser: true })"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918278557
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\user\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\user\\\\UserController.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\user\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\user\\UserController.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\user\\UserController.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\user\\UserController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\user\\",
        "sourceFileName": "UserController.js"
      }
    },
    "ast": null,
    "code": "const express = require('express');\n\nconst router = express.Router();\n\nconst bodyParser = require('body-parser');\n\nconst LocalStorage = require('node-localstorage').LocalStorage;\n\nconst config = require('../config.js');\n\nconst jwt = require('jsonwebtoken');\n\nconst localStorage = new LocalStorage('./scratch');\nrouter.use(bodyParser.urlencoded({\n  extended: true\n}));\nrouter.use(bodyParser.json());\n\nconst User = require('../models/User_model');\n\nconst Orderlist = require('../models/Order_model');\n\nconst app = express();\napp.set('view engine', 'ejs');\napp.set('views', './views');\napp.use(express.static(__dirname + '/public')); // RETURNS ALL THE USERS IN THE DATABASE\n\n/*\r\nrouter.get('/', (req, res) => {\r\n    User.find({}, (err, users) => {\r\n        if (err) return res.status(500).send(\"There was a problem finding the users.\");\r\n        res.status(200).send(users);\r\n    });\r\n});\r\n*/\n\nrouter.get('/view_shopping_list', (req, res) => {\n  var token = localStorage.getItem('authtoken');\n  console.log(\"token>>>\", token);\n\n  if (!token) {\n    res.redirect('/');\n  }\n\n  jwt.verify(token, config.secret, (err, decoded) => {\n    console.log(\"decoded ==> \", decoded);\n\n    if (err) {\n      res.redirect('/');\n    }\n\n    ;\n    User.findById(decoded.id, {\n      password: 0\n    }, function (err, user) {\n      if (err) {\n        res.redirect('/');\n      }\n\n      if (!user) {\n        res.redirect('/');\n      }\n\n      console.log(\"user ==> \", user); //res.render('profile.ejs',{user})\n\n      Orderlist.find({\n        email: user.email\n      }, (err, data) => {\n        if (err) res.status(500).send(err);else {\n          //console.log(\"data ==> \", data)\n          const now = Date.now();\n          let status;\n          let d0;\n          let sec;\n          const orders = data.map(order => {\n            //console.log(\"order ****** \", order)\n            d0 = Number(order.order_date);\n            sec = (now - d0) / 1000;\n            if (sec < 86400) status = \"In Progess\";else if (sec > 172800) status = \"Delivered\";else status = \"Dispatched\"; //console.log(d0)\n\n            const d = new Date(d0).toLocaleDateString();\n            console.log(d);\n            order[\"order_date\"] = d;\n            order[\"order_status\"] = status;\n            return order;\n          });\n          console.log(\"orders ==> \", orders);\n          console.log(\"user ==> \", user); //binding result to data to be used in OrderStatus.ejs\n\n          res.render('OrderStatus', {\n            data: orders,\n            user\n          });\n        }\n      });\n    });\n  });\n}); // GETS A SINGLE USER FROM THE DATABASE\n\n/*\r\nrouter.get('/profile', function (req, res) {\r\n    var token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\",token)\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, function(err, decoded) {\r\n    if (err) {\r\n        res.redirect('/')\r\n    };\r\n        User.findById(decoded.id, { password: 0 }, function (err, user) {\r\n            if (err) {res.redirect('/')}\r\n            if (!user) {res.redirect('/')}\r\n\r\n            console.log(\"user ==> \", user)\r\n            res.render('profile.ejs',{user})\r\n        });\r\n    });\r\n});\r\n\r\nrouter.get('/signup',  (req, res) => {\r\n    res.render('signup.ejs')\r\n });\r\n */\n\nrouter.get('/logout', (req, res) => {\n  localStorage.removeItem('authtoken');\n  res.redirect('/');\n});\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwiYm9keVBhcnNlciIsIkxvY2FsU3RvcmFnZSIsImNvbmZpZyIsImp3dCIsImxvY2FsU3RvcmFnZSIsInVzZSIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsImpzb24iLCJVc2VyIiwiT3JkZXJsaXN0IiwiYXBwIiwic2V0Iiwic3RhdGljIiwiX19kaXJuYW1lIiwiZ2V0IiwicmVxIiwicmVzIiwidG9rZW4iLCJnZXRJdGVtIiwiY29uc29sZSIsImxvZyIsInJlZGlyZWN0IiwidmVyaWZ5Iiwic2VjcmV0IiwiZXJyIiwiZGVjb2RlZCIsImZpbmRCeUlkIiwiaWQiLCJwYXNzd29yZCIsInVzZXIiLCJmaW5kIiwiZW1haWwiLCJkYXRhIiwic3RhdHVzIiwic2VuZCIsIm5vdyIsIkRhdGUiLCJkMCIsInNlYyIsIm9yZGVycyIsIm1hcCIsIm9yZGVyIiwiTnVtYmVyIiwib3JkZXJfZGF0ZSIsImQiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJyZW5kZXIiLCJyZW1vdmVJdGVtIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsT0FBTyxHQUFHQyxPQUFPLENBQUMsU0FBRCxDQUF2Qjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdGLE9BQU8sQ0FBQ0csTUFBUixFQUFmOztBQUNBLE1BQU1DLFVBQVUsR0FBR0gsT0FBTyxDQUFDLGFBQUQsQ0FBMUI7O0FBQ0EsTUFBTUksWUFBWSxHQUFHSixPQUFPLENBQUMsbUJBQUQsQ0FBUCxDQUE2QkksWUFBbEQ7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHTCxPQUFPLENBQUMsY0FBRCxDQUF0Qjs7QUFDQSxNQUFNTSxHQUFHLEdBQUdOLE9BQU8sQ0FBQyxjQUFELENBQW5COztBQUNBLE1BQU1PLFlBQVksR0FBRyxJQUFJSCxZQUFKLENBQWlCLFdBQWpCLENBQXJCO0FBRUFILE1BQU0sQ0FBQ08s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VXNlcnNcXEszMDAwNDRcXHByb2plY3RzXFxVc2VyQXV0aGVudGljYXRpb25BbmRTZWN1cml0eVxcdXNlclxcIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XHJcbmNvbnN0IExvY2FsU3RvcmFnZSA9IHJlcXVpcmUoJ25vZGUtbG9jYWxzdG9yYWdlJykuTG9jYWxTdG9yYWdlO1xyXG5jb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcuanMnKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcbmNvbnN0IGxvY2FsU3RvcmFnZSA9IG5ldyBMb2NhbFN0b3JhZ2UoJy4vc2NyYXRjaCcpO1xyXG5cclxucm91dGVyLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XHJcbnJvdXRlci51c2UoYm9keVBhcnNlci5qc29uKCkpO1xyXG5cclxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyX21vZGVsJyk7XHJcbmNvbnN0IE9yZGVybGlzdCA9IHJlcXVpcmUoJy4uL21vZGVscy9PcmRlcl9tb2RlbCcpXHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcbmFwcC5zZXQoJ3ZpZXcgZW5naW5lJywgJ2VqcycpO1xyXG5hcHAuc2V0KCd2aWV3cycsICcuL3ZpZXdzJyk7XHJcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoX19kaXJuYW1lKycvcHVibGljJykpO1xyXG5cclxuLy8gUkVUVVJOUyBBTEwgVEhFIFVTRVJTIElOIFRIRSBEQVRBQkFTRVxyXG4vKlxyXG5yb3V0ZXIuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7XHJcbiAgICBVc2VyLmZpbmQoe30sIChlcnIsIHVzZXJzKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKFwiVGhlcmUgd2FzIGEgcHJvYmxlbSBmaW5kaW5nIHRoZSB1c2Vycy5cIik7XHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLnNlbmQodXNlcnMpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4qL1xyXG5cclxucm91dGVyLmdldCgnL3ZpZXdfc2hvcHBpbmdfbGlzdCcsIChyZXEscmVzKT0+e1xyXG4gICAgdmFyIHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGh0b2tlbicpXHJcbiAgICBjb25zb2xlLmxvZyhcInRva2VuPj4+XCIsdG9rZW4pXHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgIH1cclxuICAgIGp3dC52ZXJpZnkodG9rZW4sIGNvbmZpZy5zZWNyZXQsIChlcnIsIGRlY29kZWQpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImRlY29kZWQgPT0+IFwiLCBkZWNvZGVkKVxyXG4gICAgICAgIGlmIChlcnIpIHtcclxuICAgICAgICAgICAgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgICAgICB9O1xyXG4gICAgICAgICAgICBVc2VyLmZpbmRCeUlkKGRlY29kZWQuaWQsIHsgcGFzc3dvcmQ6IDAgfSwgZnVuY3Rpb24gKGVyciwgdXNlcikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycikge3Jlcy5yZWRpcmVjdCgnLycpfVxyXG4gICAgICAgICAgICAgICAgaWYgKCF1c2VyKSB7cmVzLnJlZGlyZWN0KCcvJyl9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyID09PiBcIiwgdXNlcilcclxuICAgICAgICAgICAgICAgIC8vcmVzLnJlbmRlcigncHJvZmlsZS5lanMnLHt1c2VyfSlcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICBPcmRlcmxpc3QuZmluZCh7ZW1haWw6IHVzZXIuZW1haWx9LCAoZXJyLGRhdGEpPT57XHJcbiAgICAgICAgICAgICAgICBpZihlcnIpIHJlcy5zdGF0dXMoNTAwKS5zZW5kKGVycilcclxuICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJkYXRhID09PiBcIiwgZGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2VjXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9yZGVycyA9IGRhdGEubWFwKCBvcmRlciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwib3JkZXIgKioqKioqIFwiLCBvcmRlcilcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQwID0gTnVtYmVyKG9yZGVyLm9yZGVyX2RhdGUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWMgPSAobm93IC0gZDApLzEwMDBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWM8ODY0MDApICAgICAgICBzdGF0dXMgPSBcIkluIFByb2dlc3NcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoc2VjPjE3MjgwMCkgIHN0YXR1cyA9IFwiRGVsaXZlcmVkXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgICAgICAgICAgICAgICAgICBzdGF0dXMgPSBcIkRpc3BhdGNoZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGQwKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZCA9IG5ldyBEYXRlKGQwKS50b0xvY2FsZURhdGVTdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyW1wib3JkZXJfZGF0ZVwiXSA9IGRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyW1wib3JkZXJfc3RhdHVzXCJdID0gc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3JkZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJvcmRlcnMgPT0+IFwiLCBvcmRlcnMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlciA9PT4gXCIsIHVzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vYmluZGluZyByZXN1bHQgdG8gZGF0YSB0byBiZSB1c2VkIGluIE9yZGVyU3RhdHVzLmVqc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXMucmVuZGVyKCdPcmRlclN0YXR1cycsIHtkYXRhOiBvcmRlcnMsIHVzZXJ9KVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG59KVxyXG5cclxuLy8gR0VUUyBBIFNJTkdMRSBVU0VSIEZST00gVEhFIERBVEFCQVNFXHJcbi8qXHJcbnJvdXRlci5nZXQoJy9wcm9maWxlJywgZnVuY3Rpb24gKHJlcSwgcmVzKSB7XHJcbiAgICB2YXIgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aHRva2VuJylcclxuICAgIGNvbnNvbGUubG9nKFwidG9rZW4+Pj5cIix0b2tlbilcclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy8nKVxyXG4gICAgfVxyXG4gICAgand0LnZlcmlmeSh0b2tlbiwgY29uZmlnLnNlY3JldCwgZnVuY3Rpb24oZXJyLCBkZWNvZGVkKSB7XHJcbiAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgIH07XHJcbiAgICAgICAgVXNlci5maW5kQnlJZChkZWNvZGVkLmlkLCB7IHBhc3N3b3JkOiAwIH0sIGZ1bmN0aW9uIChlcnIsIHVzZXIpIHtcclxuICAgICAgICAgICAgaWYgKGVycikge3Jlcy5yZWRpcmVjdCgnLycpfVxyXG4gICAgICAgICAgICBpZiAoIXVzZXIpIHtyZXMucmVkaXJlY3QoJy8nKX1cclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwidXNlciA9PT4gXCIsIHVzZXIpXHJcbiAgICAgICAgICAgIHJlcy5yZW5kZXIoJ3Byb2ZpbGUuZWpzJyx7dXNlcn0pXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5yb3V0ZXIuZ2V0KCcvc2lnbnVwJywgIChyZXEsIHJlcykgPT4ge1xyXG4gICAgcmVzLnJlbmRlcignc2lnbnVwLmVqcycpXHJcbiB9KTtcclxuICovXHJcblxyXG4gcm91dGVyLmdldCgnL2xvZ291dCcsIChyZXEscmVzKSA9PiB7XHJcbiAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2F1dGh0b2tlbicpO1xyXG4gICAgIHJlcy5yZWRpcmVjdCgnLycpO1xyXG4gfSlcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcm91dGVyOyJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "UserController.js"
      ],
      "names": [
        "express",
        "require",
        "router",
        "Router",
        "bodyParser",
        "LocalStorage",
        "config",
        "jwt",
        "localStorage",
        "use",
        "urlencoded",
        "extended",
        "json",
        "User",
        "Orderlist",
        "app",
        "set",
        "static",
        "__dirname",
        "get",
        "req",
        "res",
        "token",
        "getItem",
        "console",
        "log",
        "redirect",
        "verify",
        "secret",
        "err",
        "decoded",
        "findById",
        "id",
        "password",
        "user",
        "find",
        "email",
        "data",
        "status",
        "send",
        "now",
        "Date",
        "d0",
        "sec",
        "orders",
        "map",
        "order",
        "Number",
        "order_date",
        "d",
        "toLocaleDateString",
        "render",
        "removeItem",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\user\\",
      "sourcesContent": [
        "const express = require('express');\r\nconst router = express.Router();\r\nconst bodyParser = require('body-parser');\r\nconst LocalStorage = require('node-localstorage').LocalStorage;\r\nconst config = require('../config.js');\r\nconst jwt = require('jsonwebtoken');\r\nconst localStorage = new LocalStorage('./scratch');\r\n\r\nrouter.use(bodyParser.urlencoded({ extended: true }));\r\nrouter.use(bodyParser.json());\r\n\r\nconst User = require('../models/User_model');\r\nconst Orderlist = require('../models/Order_model')\r\n\r\nconst app = express();\r\napp.set('view engine', 'ejs');\r\napp.set('views', './views');\r\napp.use(express.static(__dirname+'/public'));\r\n\r\n// RETURNS ALL THE USERS IN THE DATABASE\r\n/*\r\nrouter.get('/', (req, res) => {\r\n    User.find({}, (err, users) => {\r\n        if (err) return res.status(500).send(\"There was a problem finding the users.\");\r\n        res.status(200).send(users);\r\n    });\r\n});\r\n*/\r\n\r\nrouter.get('/view_shopping_list', (req,res)=>{\r\n    var token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\",token)\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, (err, decoded) => {\r\n        console.log(\"decoded ==> \", decoded)\r\n        if (err) {\r\n            res.redirect('/')\r\n        };\r\n            User.findById(decoded.id, { password: 0 }, function (err, user) {\r\n                if (err) {res.redirect('/')}\r\n                if (!user) {res.redirect('/')}\r\n\r\n                console.log(\"user ==> \", user)\r\n                //res.render('profile.ejs',{user})\r\n                \r\n               Orderlist.find({email: user.email}, (err,data)=>{\r\n                if(err) res.status(500).send(err)\r\n                else{\r\n                        //console.log(\"data ==> \", data)\r\n                        const now = Date.now()\r\n                        let status\r\n                        let d0\r\n                        let sec\r\n                        const orders = data.map( order => {\r\n                            //console.log(\"order ****** \", order)\r\n                            d0 = Number(order.order_date)\r\n                            sec = (now - d0)/1000\r\n                            if (sec<86400)        status = \"In Progess\"\r\n                            else if (sec>172800)  status = \"Delivered\"\r\n                            else                  status = \"Dispatched\"\r\n                            \r\n                            //console.log(d0)\r\n                            const d = new Date(d0).toLocaleDateString()\r\n                            console.log(d)\r\n                            order[\"order_date\"] = d\r\n                            order[\"order_status\"] = status\r\n                            return order\r\n                        })\r\n                        console.log(\"orders ==> \", orders)\r\n                        console.log(\"user ==> \", user)\r\n                        //binding result to data to be used in OrderStatus.ejs\r\n                        res.render('OrderStatus', {data: orders, user})\r\n                    }\r\n                })\r\n            });\r\n        });\r\n})\r\n\r\n// GETS A SINGLE USER FROM THE DATABASE\r\n/*\r\nrouter.get('/profile', function (req, res) {\r\n    var token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\",token)\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, function(err, decoded) {\r\n    if (err) {\r\n        res.redirect('/')\r\n    };\r\n        User.findById(decoded.id, { password: 0 }, function (err, user) {\r\n            if (err) {res.redirect('/')}\r\n            if (!user) {res.redirect('/')}\r\n\r\n            console.log(\"user ==> \", user)\r\n            res.render('profile.ejs',{user})\r\n        });\r\n    });\r\n});\r\n\r\nrouter.get('/signup',  (req, res) => {\r\n    res.render('signup.ejs')\r\n });\r\n */\r\n\r\n router.get('/logout', (req,res) => {\r\n     localStorage.removeItem('authtoken');\r\n     res.redirect('/');\r\n })\r\n\r\nmodule.exports = router;"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918278570
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\config.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\config.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\config.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\config.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
        "sourceFileName": "config.js"
      }
    },
    "ast": null,
    "code": "module.exports = {\n  'secret': 'supersecret'\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQUEsTUFBTSxDQUFDQyxPQUFQLEdBQWlCO0FBQ2IsWUFBVTtBQURHLENBQWpCIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcSzMwMDA0NFxccHJvamVjdHNcXFVzZXJBdXRoZW50aWNhdGlvbkFuZFNlY3VyaXR5XFwiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcclxuICAgICdzZWNyZXQnOiAnc3VwZXJzZWNyZXQnXHJcbn07Il19",
    "map": {
      "version": 3,
      "sources": [
        "config.js"
      ],
      "names": [
        "module",
        "exports"
      ],
      "mappings": "AAAAA,MAAM,CAACC,OAAP,GAAiB;AACb,YAAU;AADG,CAAjB",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\",
      "sourcesContent": [
        "module.exports = {\r\n    'secret': 'supersecret'\r\n};"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918278556
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\models\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\models\\\\User_model.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\User_model.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\User_model.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\User_model.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\",
        "sourceFileName": "User_model.js"
      }
    },
    "ast": null,
    "code": "const mongoose = require('mongoose');\n\nconst Schema = mongoose.Schema;\nconst userModel = new Schema({\n  name: {\n    type: String\n  },\n  email: {\n    type: String\n  },\n  password: {\n    type: String\n  },\n  role: {\n    type: String\n  }\n});\nmodule.exports = mongoose.model('user', userModel, 'user_list');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVzZXJfbW9kZWwuanMiXSwibmFtZXMiOlsibW9uZ29vc2UiLCJyZXF1aXJlIiwiU2NoZW1hIiwidXNlck1vZGVsIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJlbWFpbCIsInBhc3N3b3JkIiwicm9sZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJtb2RlbCJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBRCxDQUF4Qjs7QUFDQSxNQUFNQyxNQUFNLEdBQUdGLFFBQVEsQ0FBQ0UsTUFBeEI7QUFFQSxNQUFNQyxTQUFTLEdBQUcsSUFBSUQsTUFBSixDQUFXO0FBQ3pCRSxFQUFBQSxJQUFJLEVBQUU7QUFBRUMsSUFBQUEsSUFBSSxFQUFFQztBQUFSLEdBRG1CO0FBRXpCQyxFQUFBQSxLQUFLLEVBQUU7QUFBRUYsSUFBQUEsSUFBSSxFQUFFQztBQUFSLEdBRmtCO0FBR3pCRSxFQUFBQSxRQUFRLEVBQUU7QUFBRUgsSUFBQUEsSUFBSSxFQUFFQztBQUFSLEdBSGU7QUFJekJHLEVBQUFBLElBQUksRUFBRTtBQUFFSixJQUFBQSxJQUFJLEVBQUVDO0FBQVI7QUFKbUIsQ0FBWCxDQUFsQjtBQU9BSSxNQUFNLENBQUNDLE9BQVAsR0FBaUJYLFFBQVEsQ0FBQ1ksS0FBVCxDQUFlLE1BQWYsRUFBdUJULFNBQXZCLEVBQWtDLFdBQWxDLENBQWpCIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcSzMwMDA0NFxccHJvamVjdHNcXFVzZXJBdXRoZW50aWNhdGlvbkFuZFNlY3VyaXR5XFxtb2RlbHNcXCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKVxyXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWFcclxuXHJcbmNvbnN0IHVzZXJNb2RlbCA9IG5ldyBTY2hlbWEoe1xyXG4gICAgbmFtZTogeyB0eXBlOiBTdHJpbmcgfSxcclxuICAgIGVtYWlsOiB7IHR5cGU6IFN0cmluZyB9LFxyXG4gICAgcGFzc3dvcmQ6IHsgdHlwZTogU3RyaW5nIH0sXHJcbiAgICByb2xlOiB7IHR5cGU6IFN0cmluZyB9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbCgndXNlcicsIHVzZXJNb2RlbCwgJ3VzZXJfbGlzdCcpXHJcblxyXG4iXX0=",
    "map": {
      "version": 3,
      "sources": [
        "User_model.js"
      ],
      "names": [
        "mongoose",
        "require",
        "Schema",
        "userModel",
        "name",
        "type",
        "String",
        "email",
        "password",
        "role",
        "module",
        "exports",
        "model"
      ],
      "mappings": "AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,SAAS,GAAG,IAAID,MAAJ,CAAW;AACzBE,EAAAA,IAAI,EAAE;AAAEC,IAAAA,IAAI,EAAEC;AAAR,GADmB;AAEzBC,EAAAA,KAAK,EAAE;AAAEF,IAAAA,IAAI,EAAEC;AAAR,GAFkB;AAGzBE,EAAAA,QAAQ,EAAE;AAAEH,IAAAA,IAAI,EAAEC;AAAR,GAHe;AAIzBG,EAAAA,IAAI,EAAE;AAAEJ,IAAAA,IAAI,EAAEC;AAAR;AAJmB,CAAX,CAAlB;AAOAI,MAAM,CAACC,OAAP,GAAiBX,QAAQ,CAACY,KAAT,CAAe,MAAf,EAAuBT,SAAvB,EAAkC,WAAlC,CAAjB",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\",
      "sourcesContent": [
        "const mongoose = require('mongoose')\r\nconst Schema = mongoose.Schema\r\n\r\nconst userModel = new Schema({\r\n    name: { type: String },\r\n    email: { type: String },\r\n    password: { type: String },\r\n    role: { type: String }\r\n});\r\n\r\nmodule.exports = mongoose.model('user', userModel, 'user_list')\r\n\r\n"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918833945
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\models\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\models\\\\Order_model.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\Order_model.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\Order_model.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\Order_model.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\",
        "sourceFileName": "Order_model.js"
      }
    },
    "ast": null,
    "code": "const mongoose = require('mongoose');\n\nconst Schema = mongoose.Schema;\nconst orderModel = new Schema({\n  name: {\n    type: String\n  },\n  email: {\n    type: String\n  },\n  address: {\n    type: String\n  },\n  product_name: {\n    type: String\n  },\n  unit_price: {\n    type: String\n  },\n  quantity: {\n    type: String\n  },\n  order_date: {\n    type: String\n  }\n});\nmodule.exports = mongoose.model('orderlist', orderModel, 'order_list');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk9yZGVyX21vZGVsLmpzIl0sIm5hbWVzIjpbIm1vbmdvb3NlIiwicmVxdWlyZSIsIlNjaGVtYSIsIm9yZGVyTW9kZWwiLCJuYW1lIiwidHlwZSIsIlN0cmluZyIsImVtYWlsIiwiYWRkcmVzcyIsInByb2R1Y3RfbmFtZSIsInVuaXRfcHJpY2UiLCJxdWFudGl0eSIsIm9yZGVyX2RhdGUiLCJtb2R1bGUiLCJleHBvcnRzIiwibW9kZWwiXSwibWFwcGluZ3MiOiJBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQUQsQ0FBeEI7O0FBQ0EsTUFBTUMsTUFBTSxHQUFHRixRQUFRLENBQUNFLE1BQXhCO0FBRUEsTUFBTUMsVUFBVSxHQUFHLElBQUlELE1BQUosQ0FBVztBQUMxQkUsRUFBQUEsSUFBSSxFQUFFO0FBQUVDLElBQUFBLElBQUksRUFBRUM7QUFBUixHQURvQjtBQUUxQkMsRUFBQUEsS0FBSyxFQUFFO0FBQUVGLElBQUFBLElBQUksRUFBRUM7QUFBUixHQUZtQjtBQUcxQkUsRUFBQUEsT0FBTyxFQUFFO0FBQUVILElBQUFBLElBQUksRUFBRUM7QUFBUixHQUhpQjtBQUkxQkcsRUFBQUEsWUFBWSxFQUFFO0FBQUVKLElBQUFBLElBQUksRUFBRUM7QUFBUixHQUpZO0FBSzFCSSxFQUFBQSxVQUFVLEVBQUU7QUFBRUwsSUFBQUEsSUFBSSxFQUFFQztBQUFSLEdBTGM7QUFNMUJLLEVBQUFBLFFBQVEsRUFBRTtBQUFFTixJQUFBQSxJQUFJLEVBQUVDO0FBQVIsR0FOZ0I7QUFPMUJNLEVBQUFBLFVBQVUsRUFBRTtBQUFFUCxJQUFBQSxJQUFJLEVBQUVDO0FBQVI7QUFQYyxDQUFYLENBQW5CO0FBVUFPLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQmQsUUFBUSxDQUFDZSxLQUFULENBQWUsV0FBZixFQUE0QlosVUFBNUIsRUFBd0MsWUFBeEMsQ0FBakIiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxLMzAwMDQ0XFxwcm9qZWN0c1xcVXNlckF1dGhlbnRpY2F0aW9uQW5kU2VjdXJpdHlcXG1vZGVsc1xcIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpXHJcbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYVxyXG5cclxuY29uc3Qgb3JkZXJNb2RlbCA9IG5ldyBTY2hlbWEoe1xyXG4gICAgbmFtZTogeyB0eXBlOiBTdHJpbmcgfSxcclxuICAgIGVtYWlsOiB7IHR5cGU6IFN0cmluZyB9LFxyXG4gICAgYWRkcmVzczogeyB0eXBlOiBTdHJpbmcgfSxcclxuICAgIHByb2R1Y3RfbmFtZTogeyB0eXBlOiBTdHJpbmcgfSxcclxuICAgIHVuaXRfcHJpY2U6IHsgdHlwZTogU3RyaW5nIH0sXHJcbiAgICBxdWFudGl0eTogeyB0eXBlOiBTdHJpbmcgfSxcclxuICAgIG9yZGVyX2RhdGU6IHsgdHlwZTogU3RyaW5nIH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IG1vbmdvb3NlLm1vZGVsKCdvcmRlcmxpc3QnLCBvcmRlck1vZGVsLCAnb3JkZXJfbGlzdCcpIl19",
    "map": {
      "version": 3,
      "sources": [
        "Order_model.js"
      ],
      "names": [
        "mongoose",
        "require",
        "Schema",
        "orderModel",
        "name",
        "type",
        "String",
        "email",
        "address",
        "product_name",
        "unit_price",
        "quantity",
        "order_date",
        "module",
        "exports",
        "model"
      ],
      "mappings": "AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAxB;AAEA,MAAMC,UAAU,GAAG,IAAID,MAAJ,CAAW;AAC1BE,EAAAA,IAAI,EAAE;AAAEC,IAAAA,IAAI,EAAEC;AAAR,GADoB;AAE1BC,EAAAA,KAAK,EAAE;AAAEF,IAAAA,IAAI,EAAEC;AAAR,GAFmB;AAG1BE,EAAAA,OAAO,EAAE;AAAEH,IAAAA,IAAI,EAAEC;AAAR,GAHiB;AAI1BG,EAAAA,YAAY,EAAE;AAAEJ,IAAAA,IAAI,EAAEC;AAAR,GAJY;AAK1BI,EAAAA,UAAU,EAAE;AAAEL,IAAAA,IAAI,EAAEC;AAAR,GALc;AAM1BK,EAAAA,QAAQ,EAAE;AAAEN,IAAAA,IAAI,EAAEC;AAAR,GANgB;AAO1BM,EAAAA,UAAU,EAAE;AAAEP,IAAAA,IAAI,EAAEC;AAAR;AAPc,CAAX,CAAnB;AAUAO,MAAM,CAACC,OAAP,GAAiBd,QAAQ,CAACe,KAAT,CAAe,WAAf,EAA4BZ,UAA5B,EAAwC,YAAxC,CAAjB",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\models\\",
      "sourcesContent": [
        "const mongoose = require('mongoose')\r\nconst Schema = mongoose.Schema\r\n\r\nconst orderModel = new Schema({\r\n    name: { type: String },\r\n    email: { type: String },\r\n    address: { type: String },\r\n    product_name: { type: String },\r\n    unit_price: { type: String },\r\n    quantity: { type: String },\r\n    order_date: { type: String }\r\n});\r\n\r\nmodule.exports = mongoose.model('orderlist', orderModel, 'order_list')"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918837423
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\auth\\\\AuthController.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\auth\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\auth\\AuthController.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\auth\\AuthController.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\auth\\AuthController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\auth\\",
        "sourceFileName": "AuthController.js"
      }
    },
    "ast": null,
    "code": "const express = require('express');\n\nconst router = express.Router();\n\nconst LocalStorage = require('node-localstorage').LocalStorage;\n\nconst localStorage = new LocalStorage('./scratch');\nconst app = express(); // For parsing form\n\nconst bodyParser = require('body-parser'); // For generating Token\n\n\nconst jwt = require('jsonwebtoken'); // For encrypting Password\n\n\nconst bcrypt = require('bcryptjs'); // For Secert Token\n\n\nconst config = require('../config'); // For User Schema\n\n\nconst User = require('../models/User_model');\n\nconst session = require('express-session');\n\nrouter.use(session({\n  secret: 'edurekaSecret1',\n  resave: false,\n  saveUninitialized: true\n}));\napp.use(express.static(__dirname + '/public'));\napp.set('view engine', 'ejs');\napp.set('views', './views');\nrouter.use(bodyParser.urlencoded({\n  extended: false\n}));\nrouter.use(bodyParser.json()); // Register 1st Admin without JWT validation\n\nrouter.post('/registerAdmin', (req, res) => {\n  console.log(\"/registerAdmin : req.body ==> \", req.body);\n  User.findOne({\n    email: req.body.email\n  }, (err, user) => {\n    if (err) return res.status(500).send('Error on the server.');\n    let htmlMsg;\n\n    if (!user) {\n      //add new user\n      const hashedPasword = bcrypt.hashSync(req.body.password, 8);\n      User.create({\n        name: req.body.name,\n        email: req.body.email,\n        password: hashedPasword,\n        role: req.body.role\n      }, (err, user) => {\n        if (err) return res.status(500).send('There was a problem registering user');\n        htmlMsg = encodeURIComponent('Registered OK, disable after first admin created !');\n        res.redirect('/admin?msg=' + htmlMsg);\n      });\n    } else {\n      //duplicate\n      htmlMsg = encodeURIComponent('Email existing, please enter a new one ...');\n      res.redirect('/admin?msg=' + htmlMsg);\n    }\n  });\n}); // Register a User\n\nrouter.post('/register', (req, res) => {\n  console.log(\"/register : req.body ==> \", req.body);\n  User.findOne({\n    email: req.body.email\n  }, (err, user) => {\n    if (err) return res.status(500).send('Error on the server.');\n    let htmlMsg;\n\n    if (!user) {\n      //add new user\n      const hashedPasword = bcrypt.hashSync(req.body.password, 8);\n      User.create({\n        name: req.body.name,\n        email: req.body.email,\n        password: hashedPasword,\n        role: \"normal\"\n      }, (err, user) => {\n        if (err) return res.status(500).send('There was a problem registering user');\n        htmlMsg = encodeURIComponent('Registered OK !');\n        res.redirect('/?msg=' + htmlMsg);\n      });\n    } else {\n      //duplicate\n      htmlMsg = encodeURIComponent('Email existing, please enter a new one ...');\n      res.redirect('/?msg=' + htmlMsg);\n    }\n  });\n}); // Login User\n\nrouter.post('/login', (req, res) => {\n  User.findOne({\n    email: req.body.email\n  }, (err, user) => {\n    console.log(\"/login : user => \", user);\n    if (err) return res.status(500).send('Error on the server.');\n    let htmlMsg;\n\n    if (!user) {\n      htmlMsg = encodeURIComponent('Email not found, try again ...');\n      res.redirect('/?invalid=' + htmlMsg);\n    } else {\n      const passwordIsValid = bcrypt.compareSync(req.body.password, user.password);\n\n      if (!passwordIsValid) {\n        return res.status(401).send({\n          auth: false,\n          token: null\n        });\n      }\n\n      var token = jwt.sign({\n        id: user._id\n      }, config.secret, {\n        expiresIn: 86400 // expires in 24 hours\n\n      });\n      localStorage.setItem('authtoken', token);\n\n      if (user.role == 'admin') {\n        res.redirect(`/admin/userDashboard`);\n      } else {\n        res.redirect(`/users/view_shopping_list`);\n      }\n    }\n  });\n}); // Info of logined User\n\nrouter.get('/loginedUser', function (req, res) {\n  var token = req.headers['x-access-token'];\n  if (!token) return res.status(401).send({\n    auth: false,\n    message: 'No token provided.'\n  });\n  jwt.verify(token, config.secret, function (err, decoded) {\n    if (err) return res.status(500).send({\n      auth: false,\n      message: 'Failed to authenticate token.'\n    });\n    User.findById(decoded.id, {\n      password: 0\n    }, function (err, user) {\n      if (err) return res.status(500).send(\"There was a problem finding the user.\");\n      if (!user) return res.status(404).send(\"No user found.\");\n      res.status(200).send(user);\n    });\n  });\n});\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF1dGhDb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbImV4cHJlc3MiLCJyZXF1aXJlIiwicm91dGVyIiwiUm91dGVyIiwiTG9jYWxTdG9yYWdlIiwibG9jYWxTdG9yYWdlIiwiYXBwIiwiYm9keVBhcnNlciIsImp3dCIsImJjcnlwdCIsImNvbmZpZyIsIlVzZXIiLCJzZXNzaW9uIiwidXNlIiwic2VjcmV0IiwicmVzYXZlIiwic2F2ZVVuaW5pdGlhbGl6ZWQiLCJzdGF0aWMiLCJfX2Rpcm5hbWUiLCJzZXQiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJqc29uIiwicG9zdCIsInJlcSIsInJlcyIsImNvbnNvbGUiLCJsb2ciLCJib2R5IiwiZmluZE9uZSIsImVtYWlsIiwiZXJyIiwidXNlciIsInN0YXR1cyIsInNlbmQiLCJodG1sTXNnIiwiaGFzaGVkUGFzd29yZCIsImhhc2hTeW5jIiwicGFzc3dvcmQiLCJjcmVhdGUiLCJuYW1lIiwicm9sZSIsImVuY29kZVVSSUNvbXBvbmVudCIsInJlZGlyZWN0IiwicGFzc3dvcmRJc1ZhbGlkIiwiY29tcGFyZVN5bmMiLCJhdXRoIiwidG9rZW4iLCJzaWduIiwiaWQiLCJfaWQiLCJleHBpcmVzSW4iLCJzZXRJdGVtIiwiZ2V0IiwiaGVhZGVycyIsIm1lc3NhZ2UiLCJ2ZXJpZnkiLCJkZWNvZGVkIiwiZmluZEJ5SWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFSLEVBQWY7O0FBQ0EsTUFBTUMsWUFBWSxHQUFHSCxPQUFPLENBQUMsbUJBQUQsQ0FBUCxDQUE2QkcsWUFBbEQ7O0FBQ0EsTUFBTUMsWUFBWSxHQUFHLElBQUlELFlBQUosQ0FBaUIsV0FBakIsQ0FBckI7QUFDQSxNQUFNRSxHQUFHLEdBQUdOLE9BQU8sRUFBbkIsQyxDQUNBOztBQUNBLE1BQU1PLFVB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QSxPQUFPLEVBQUU7QUFBeEIsS0FBckIsQ0FBUDtBQUVUNUMsSUFBQUEsSUFBSSxDQUFDK0MsUUFBTCxDQUFjRCxPQUFPLENBQUNSLEVBQXRCLEVBQTBCO0FBQUVYLE1BQUFBLFFBQVEsRUFBRTtBQUFaLEtBQTFCLEVBQTJDLFVBQVVQLEdBQVYsRUFBZUMsSUFBZixFQUFxQjtBQUM5RCxVQUFJRCxHQUFKLEVBQVMsT0FBT04sR0FBRyxDQUFDUSxNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUIsdUNBQXJCLENBQVA7QUFDVCxVQUFJLENBQUNGLElBQUwsRUFBVyxPQUFPUCxHQUFHLENBQUNRLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQixnQkFBckIsQ0FBUDtBQUVYVCxNQUFBQSxHQUFHLENBQUNRLE1BQUosQ0FBVyxHQUFYLEVBQWdCQyxJQUFoQixDQUFxQkYsSUFBckI7QUFDRCxLQUxEO0FBTUQsR0FURDtBQVVELENBZEQ7QUFrQkEyQixNQUFNLENBQUNDLE9BQVAsR0FBaUIxRCxNQUFqQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXEszMDAwNDRcXHByb2plY3RzXFxVc2VyQXV0aGVudGljYXRpb25BbmRTZWN1cml0eVxcYXV0aFxcIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcclxuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcclxuY29uc3QgTG9jYWxTdG9yYWdlID0gcmVxdWlyZSgnbm9kZS1sb2NhbHN0b3JhZ2UnKS5Mb2NhbFN0b3JhZ2U7XHJcbmNvbnN0IGxvY2FsU3RvcmFnZSA9IG5ldyBMb2NhbFN0b3JhZ2UoJy4vc2NyYXRjaCcpO1xyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcbi8vIEZvciBwYXJzaW5nIGZvcm1cclxuY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7XHJcbi8vIEZvciBnZW5lcmF0aW5nIFRva2VuXHJcbmNvbnN0IGp3dCA9IHJlcXVpcmUoJ2pzb253ZWJ0b2tlbicpO1xyXG4vLyBGb3IgZW5jcnlwdGluZyBQYXNzd29yZFxyXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpO1xyXG4vLyBGb3IgU2VjZXJ0IFRva2VuXHJcbmNvbnN0IGNvbmZpZyA9IHJlcXVpcmUoJy4uL2NvbmZpZycpO1xyXG4vLyBGb3IgVXNlciBTY2hlbWFcclxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyX21vZGVsJyk7XHJcbmNvbnN0IHNlc3Npb24gPSByZXF1aXJlKCdleHByZXNzLXNlc3Npb24nKTtcclxuXHJcbnJvdXRlci51c2Uoc2Vzc2lvbih7IHNlY3JldDogJ2VkdXJla2FTZWNyZXQxJywgcmVzYXZlOiBmYWxzZSwgc2F2ZVVuaW5pdGlhbGl6ZWQ6IHRydWUgfSkpO1xyXG5hcHAudXNlKGV4cHJlc3Muc3RhdGljKF9fZGlybmFtZSArICcvcHVibGljJykpO1xyXG5hcHAuc2V0KCd2aWV3IGVuZ2luZScsICdlanMnKTtcclxuYXBwLnNldCgndmlld3MnLCAnLi92aWV3cycpO1xyXG5cclxucm91dGVyLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogZmFsc2UgfSkpO1xyXG5yb3V0ZXIudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcclxuXHJcbi8vIFJlZ2lzdGVyIDFzdCBBZG1pbiB3aXRob3V0IEpXVCB2YWxpZGF0aW9uXHJcbnJvdXRlci5wb3N0KCcvcmVnaXN0ZXJBZG1pbicsIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnNvbGUubG9nKFwiL3JlZ2lzdGVyQWRtaW4gOiByZXEuYm9keSA9PT4gXCIsIHJlcS5ib2R5KVxyXG4gIFVzZXIuZmluZE9uZSh7IGVtYWlsOiByZXEuYm9keS5lbWFpbCB9LCAoZXJyLCB1c2VyKSA9PiB7XHJcbiAgICBpZiAoZXJyKSByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoJ0Vycm9yIG9uIHRoZSBzZXJ2ZXIuJyk7XHJcbiAgICBsZXQgaHRtbE1zZ1xyXG4gICAgaWYgKCF1c2VyKSB7IC8vYWRkIG5ldyB1c2VyXHJcbiAgICAgIGNvbnN0IGhhc2hlZFBhc3dvcmQgPSBiY3J5cHQuaGFzaFN5bmMocmVxLmJvZHkucGFzc3dvcmQsIDgpO1xyXG4gICAgICBVc2VyLmNyZWF0ZSh7XHJcbiAgICAgICAgbmFtZTogcmVxLmJvZHkubmFtZSxcclxuICAgICAgICBlbWFpbDogcmVxLmJvZHkuZW1haWwsXHJcbiAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3dvcmQsXHJcbiAgICAgICAgcm9sZTogcmVxLmJvZHkucm9sZVxyXG4gICAgICB9LCAoZXJyLCB1c2VyKSA9PiB7XHJcbiAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHJlZ2lzdGVyaW5nIHVzZXInKVxyXG4gICAgICAgIGh0bWxNc2cgPSBlbmNvZGVVUklDb21wb25lbnQoJ1JlZ2lzdGVyZWQgT0ssIGRpc2FibGUgYWZ0ZXIgZmlyc3QgYWRtaW4gY3JlYXRlZCAhJyk7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvYWRtaW4/bXNnPScgKyBodG1sTXNnKVxyXG4gICAgICB9KVxyXG4gICAgfSBlbHNlIHsgLy9kdXBsaWNhdGVcclxuICAgICAgaHRtbE1zZyA9IGVuY29kZVVSSUNvbXBvbmVudCgnRW1haWwgZXhpc3RpbmcsIHBsZWFzZSBlbnRlciBhIG5ldyBvbmUgLi4uJyk7XHJcbiAgICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluP21zZz0nICsgaHRtbE1zZyk7XHJcbiAgICB9XHJcbiAgfSlcclxuXHJcbn0pXHJcblxyXG4vLyBSZWdpc3RlciBhIFVzZXJcclxucm91dGVyLnBvc3QoJy9yZWdpc3RlcicsIChyZXEsIHJlcykgPT4ge1xyXG4gIGNvbnNvbGUubG9nKFwiL3JlZ2lzdGVyIDogcmVxLmJvZHkgPT0+IFwiLCByZXEuYm9keSlcclxuICBVc2VyLmZpbmRPbmUoeyBlbWFpbDogcmVxLmJvZHkuZW1haWwgfSwgKGVyciwgdXNlcikgPT4ge1xyXG4gICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKCdFcnJvciBvbiB0aGUgc2VydmVyLicpO1xyXG4gICAgbGV0IGh0bWxNc2dcclxuICAgIGlmICghdXNlcikgeyAvL2FkZCBuZXcgdXNlclxyXG4gICAgICBjb25zdCBoYXNoZWRQYXN3b3JkID0gYmNyeXB0Lmhhc2hTeW5jKHJlcS5ib2R5LnBhc3N3b3JkLCA4KTtcclxuICAgICAgVXNlci5jcmVhdGUoe1xyXG4gICAgICAgIG5hbWU6IHJlcS5ib2R5Lm5hbWUsXHJcbiAgICAgICAgZW1haWw6IHJlcS5ib2R5LmVtYWlsLFxyXG4gICAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXN3b3JkLFxyXG4gICAgICAgIHJvbGU6IFwibm9ybWFsXCJcclxuICAgICAgfSwgKGVyciwgdXNlcikgPT4ge1xyXG4gICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCgnVGhlcmUgd2FzIGEgcHJvYmxlbSByZWdpc3RlcmluZyB1c2VyJylcclxuICAgICAgICBodG1sTXNnID0gZW5jb2RlVVJJQ29tcG9uZW50KCdSZWdpc3RlcmVkIE9LICEnKTtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy8/bXNnPScgKyBodG1sTXNnKVxyXG4gICAgICB9KVxyXG4gICAgfSBlbHNlIHsgLy9kdXBsaWNhdGVcclxuICAgICAgaHRtbE1zZyA9IGVuY29kZVVSSUNvbXBvbmVudCgnRW1haWwgZXhpc3RpbmcsIHBsZWFzZSBlbnRlciBhIG5ldyBvbmUgLi4uJyk7XHJcbiAgICAgIHJlcy5yZWRpcmVjdCgnLz9tc2c9JyArIGh0bWxNc2cpO1xyXG4gICAgfVxyXG4gIH0pXHJcbn0pO1xyXG5cclxuLy8gTG9naW4gVXNlclxyXG5yb3V0ZXIucG9zdCgnL2xvZ2luJywgKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gIFVzZXIuZmluZE9uZSh7IGVtYWlsOiByZXEuYm9keS5lbWFpbCB9LCAoZXJyLCB1c2VyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIi9sb2dpbiA6IHVzZXIgPT4gXCIsIHVzZXIpXHJcbiAgICBpZiAoZXJyKSByZXR1cm4gcmVzLnN0YXR1cyg1MDApLnNlbmQoJ0Vycm9yIG9uIHRoZSBzZXJ2ZXIuJyk7XHJcbiAgICBsZXQgaHRtbE1zZ1xyXG4gICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgIGh0bWxNc2cgPSBlbmNvZGVVUklDb21wb25lbnQoJ0VtYWlsIG5vdCBmb3VuZCwgdHJ5IGFnYWluIC4uLicpO1xyXG4gICAgICByZXMucmVkaXJlY3QoJy8/aW52YWxpZD0nICsgaHRtbE1zZyk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zdCBwYXNzd29yZElzVmFsaWQgPSBiY3J5cHQuY29tcGFyZVN5bmMocmVxLmJvZHkucGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xyXG4gICAgICBpZiAoIXBhc3N3b3JkSXNWYWxpZCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZCh7IGF1dGg6IGZhbHNlLCB0b2tlbjogbnVsbCB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFyIHRva2VuID0gand0LnNpZ24oeyBpZDogdXNlci5faWQgfSwgY29uZmlnLnNlY3JldCwge1xyXG4gICAgICAgIGV4cGlyZXNJbjogODY0MDAgLy8gZXhwaXJlcyBpbiAyNCBob3Vyc1xyXG4gICAgICB9KTtcclxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2F1dGh0b2tlbicsIHRva2VuKVxyXG5cclxuICAgICAgaWYgKHVzZXIucm9sZSA9PSAnYWRtaW4nKSB7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KGAvYWRtaW4vdXNlckRhc2hib2FyZGApXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KGAvdXNlcnMvdmlld19zaG9wcGluZ19saXN0YCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9KTtcclxufSk7XHJcblxyXG4vLyBJbmZvIG9mIGxvZ2luZWQgVXNlclxyXG5yb3V0ZXIuZ2V0KCcvbG9naW5lZFVzZXInLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcclxuICB2YXIgdG9rZW4gPSByZXEuaGVhZGVyc1sneC1hY2Nlc3MtdG9rZW4nXTtcclxuICBpZiAoIXRva2VuKSByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoeyBhdXRoOiBmYWxzZSwgbWVzc2FnZTogJ05vIHRva2VuIHByb3ZpZGVkLicgfSk7XHJcblxyXG4gIGp3dC52ZXJpZnkodG9rZW4sIGNvbmZpZy5zZWNyZXQsIGZ1bmN0aW9uIChlcnIsIGRlY29kZWQpIHtcclxuICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCh7IGF1dGg6IGZhbHNlLCBtZXNzYWdlOiAnRmFpbGVkIHRvIGF1dGhlbnRpY2F0ZSB0b2tlbi4nIH0pO1xyXG5cclxuICAgIFVzZXIuZmluZEJ5SWQoZGVjb2RlZC5pZCwgeyBwYXNzd29yZDogMCB9LCBmdW5jdGlvbiAoZXJyLCB1c2VyKSB7XHJcbiAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZChcIlRoZXJlIHdhcyBhIHByb2JsZW0gZmluZGluZyB0aGUgdXNlci5cIik7XHJcbiAgICAgIGlmICghdXNlcikgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5zZW5kKFwiTm8gdXNlciBmb3VuZC5cIik7XHJcblxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZCh1c2VyKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59KTtcclxuXHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXIiXX0=",
    "map": {
      "version": 3,
      "sources": [
        "AuthController.js"
      ],
      "names": [
        "express",
        "require",
        "router",
        "Router",
        "LocalStorage",
        "localStorage",
        "app",
        "bodyParser",
        "jwt",
        "bcrypt",
        "config",
        "User",
        "session",
        "use",
        "secret",
        "resave",
        "saveUninitialized",
        "static",
        "__dirname",
        "set",
        "urlencoded",
        "extended",
        "json",
        "post",
        "req",
        "res",
        "console",
        "log",
        "body",
        "findOne",
        "email",
        "err",
        "user",
        "status",
        "send",
        "htmlMsg",
        "hashedPasword",
        "hashSync",
        "password",
        "create",
        "name",
        "role",
        "encodeURIComponent",
        "redirect",
        "passwordIsValid",
        "compareSync",
        "auth",
        "token",
        "sign",
        "id",
        "_id",
        "expiresIn",
        "setItem",
        "get",
        "headers",
        "message",
        "verify",
        "decoded",
        "findById",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\auth\\",
      "sourcesContent": [
        "const express = require('express');\r\nconst router = express.Router();\r\nconst LocalStorage = require('node-localstorage').LocalStorage;\r\nconst localStorage = new LocalStorage('./scratch');\r\nconst app = express();\r\n// For parsing form\r\nconst bodyParser = require('body-parser');\r\n// For generating Token\r\nconst jwt = require('jsonwebtoken');\r\n// For encrypting Password\r\nconst bcrypt = require('bcryptjs');\r\n// For Secert Token\r\nconst config = require('../config');\r\n// For User Schema\r\nconst User = require('../models/User_model');\r\nconst session = require('express-session');\r\n\r\nrouter.use(session({ secret: 'edurekaSecret1', resave: false, saveUninitialized: true }));\r\napp.use(express.static(__dirname + '/public'));\r\napp.set('view engine', 'ejs');\r\napp.set('views', './views');\r\n\r\nrouter.use(bodyParser.urlencoded({ extended: false }));\r\nrouter.use(bodyParser.json());\r\n\r\n// Register 1st Admin without JWT validation\r\nrouter.post('/registerAdmin', (req, res) => {\r\n  console.log(\"/registerAdmin : req.body ==> \", req.body)\r\n  User.findOne({ email: req.body.email }, (err, user) => {\r\n    if (err) return res.status(500).send('Error on the server.');\r\n    let htmlMsg\r\n    if (!user) { //add new user\r\n      const hashedPasword = bcrypt.hashSync(req.body.password, 8);\r\n      User.create({\r\n        name: req.body.name,\r\n        email: req.body.email,\r\n        password: hashedPasword,\r\n        role: req.body.role\r\n      }, (err, user) => {\r\n        if (err) return res.status(500).send('There was a problem registering user')\r\n        htmlMsg = encodeURIComponent('Registered OK, disable after first admin created !');\r\n        res.redirect('/admin?msg=' + htmlMsg)\r\n      })\r\n    } else { //duplicate\r\n      htmlMsg = encodeURIComponent('Email existing, please enter a new one ...');\r\n      res.redirect('/admin?msg=' + htmlMsg);\r\n    }\r\n  })\r\n\r\n})\r\n\r\n// Register a User\r\nrouter.post('/register', (req, res) => {\r\n  console.log(\"/register : req.body ==> \", req.body)\r\n  User.findOne({ email: req.body.email }, (err, user) => {\r\n    if (err) return res.status(500).send('Error on the server.');\r\n    let htmlMsg\r\n    if (!user) { //add new user\r\n      const hashedPasword = bcrypt.hashSync(req.body.password, 8);\r\n      User.create({\r\n        name: req.body.name,\r\n        email: req.body.email,\r\n        password: hashedPasword,\r\n        role: \"normal\"\r\n      }, (err, user) => {\r\n        if (err) return res.status(500).send('There was a problem registering user')\r\n        htmlMsg = encodeURIComponent('Registered OK !');\r\n        res.redirect('/?msg=' + htmlMsg)\r\n      })\r\n    } else { //duplicate\r\n      htmlMsg = encodeURIComponent('Email existing, please enter a new one ...');\r\n      res.redirect('/?msg=' + htmlMsg);\r\n    }\r\n  })\r\n});\r\n\r\n// Login User\r\nrouter.post('/login', (req, res) => {\r\n\r\n  User.findOne({ email: req.body.email }, (err, user) => {\r\n    console.log(\"/login : user => \", user)\r\n    if (err) return res.status(500).send('Error on the server.');\r\n    let htmlMsg\r\n    if (!user) {\r\n      htmlMsg = encodeURIComponent('Email not found, try again ...');\r\n      res.redirect('/?invalid=' + htmlMsg);\r\n    } else {\r\n      const passwordIsValid = bcrypt.compareSync(req.body.password, user.password);\r\n      if (!passwordIsValid) {\r\n        return res.status(401).send({ auth: false, token: null });\r\n      }\r\n\r\n      var token = jwt.sign({ id: user._id }, config.secret, {\r\n        expiresIn: 86400 // expires in 24 hours\r\n      });\r\n      localStorage.setItem('authtoken', token)\r\n\r\n      if (user.role == 'admin') {\r\n        res.redirect(`/admin/userDashboard`)\r\n      } else {\r\n        res.redirect(`/users/view_shopping_list`);\r\n      }\r\n    }\r\n  });\r\n});\r\n\r\n// Info of logined User\r\nrouter.get('/loginedUser', function (req, res) {\r\n  var token = req.headers['x-access-token'];\r\n  if (!token) return res.status(401).send({ auth: false, message: 'No token provided.' });\r\n\r\n  jwt.verify(token, config.secret, function (err, decoded) {\r\n    if (err) return res.status(500).send({ auth: false, message: 'Failed to authenticate token.' });\r\n\r\n    User.findById(decoded.id, { password: 0 }, function (err, user) {\r\n      if (err) return res.status(500).send(\"There was a problem finding the user.\");\r\n      if (!user) return res.status(404).send(\"No user found.\");\r\n\r\n      res.status(200).send(user);\r\n    });\r\n  });\r\n});\r\n\r\n\r\n\r\nmodule.exports = router"
      ]
    },
    "sourceType": "module",
    "mtime": 1613919530538
  },
  "{\"sourceRoot\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\admin\\\\\",\"caller\":{\"name\":\"@babel/register\"},\"cwd\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"filename\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\\\\admin\\\\AdminController.js\",\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\K300044\\\\projects\\\\UserAuthenticationAndSecurity\",\"plugins\":[],\"presets\":[]}:7.12.17": {
    "metadata": {},
    "options": {
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\admin\\",
      "caller": {
        "name": "@babel/register"
      },
      "cwd": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\admin\\AdminController.js",
      "cloneInputAst": true,
      "babelrc": false,
      "configFile": false,
      "envName": "development",
      "root": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity",
      "sourceMaps": "both",
      "ast": false,
      "passPerPreset": false,
      "plugins": [],
      "presets": [],
      "parserOpts": {
        "sourceType": "module",
        "sourceFileName": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\admin\\AdminController.js",
        "plugins": []
      },
      "generatorOpts": {
        "filename": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\admin\\AdminController.js",
        "comments": true,
        "compact": "auto",
        "sourceMaps": "both",
        "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\admin\\",
        "sourceFileName": "AdminController.js"
      }
    },
    "ast": null,
    "code": "const express = require('express');\n\nconst router = express.Router();\n\nconst LocalStorage = require('node-localstorage').LocalStorage;\n\nconst localStorage = new LocalStorage('./scratch');\n\nconst config = require('../config.js');\n\nconst jwt = require('jsonwebtoken');\n\nconst bcrypt = require('bcryptjs');\n\nconst bodyParser = require('body-parser');\n\nrouter.use(bodyParser.urlencoded({\n  extended: true\n}));\nrouter.use(bodyParser.json());\n\nconst User = require('../models/User_model');\n\nconst Orderlist = require('../models/Order_model');\n\nconst app = express();\napp.set('view engine', 'ejs');\napp.set('views', './views');\napp.use(express.static(__dirname + '/public'));\n\nconst session = require('express-session');\n\nrouter.use(session({\n  secret: 'edurekaSecret1',\n  resave: false,\n  saveUninitialized: true\n}));\nrouter.post('/addOneOrder', (req, res) => {\n  console.log(\"/addOneOrder : req.body : \", req.body);\n  const token = localStorage.getItem('authtoken');\n  console.log(\"token>>>\", token);\n\n  if (!token) {\n    res.redirect('/');\n  }\n\n  jwt.verify(token, config.secret, (err, decoded) => {\n    if (err) res.redirect('/');\n    User.findById(decoded.id, {\n      password: 0\n    }, (err, user) => {\n      if (err) {\n        res.redirect('/');\n      }\n\n      if (!user) {\n        res.redirect('/');\n      }\n\n      console.log(\"/addOneOrder : user ==> \", user);\n      const d = Date.now();\n      const order = { ...req.body,\n        order_date: d\n      };\n      console.log(\"/addOneOrder : order => \", order);\n      Orderlist.create(order, (err, data) => {\n        if (err) return res.status(500).send('There was a problem registering user');\n        console.log(`Inserted ... ${data} `);\n        const htmlMsg = encodeURIComponent('Added New Order DONE !');\n        res.redirect('/admin/shoppingDashboard?msg=' + htmlMsg);\n      });\n    });\n  });\n}); // add user\n\nrouter.post('/addUser', (req, res) => {\n  const token = localStorage.getItem('authtoken');\n  console.log(\"token>>>\", token);\n\n  if (!token) {\n    res.redirect('/');\n  }\n\n  jwt.verify(token, config.secret, (err, decoded) => {\n    if (err) {\n      res.redirect('/');\n    }\n\n    ;\n    User.findById(decoded.id, {\n      password: 0\n    }, (err, user) => {\n      if (err) {\n        res.redirect('/');\n      }\n\n      if (!user) {\n        res.redirect('/');\n      }\n\n      console.log(\"admin/addUser : user ==> \", user);\n      console.log(\"/admin/addUser : req.body ==> \", req.body);\n      User.findOne({\n        email: req.body.email\n      }, (err, user) => {\n        if (err) return res.status(500).send('Error on the server.');\n        let htmlMsg;\n\n        if (!user) {\n          const hashedPasword = bcrypt.hashSync(req.body.password, 8);\n          User.create({\n            name: req.body.name,\n            email: req.body.email,\n            password: hashedPasword,\n            role: req.body.role\n          }, (err, user) => {\n            if (err) return res.status(500).send('There was a problem registering user');\n            htmlMsg = encodeURIComponent('Added New User DONE !');\n            res.redirect('/admin/userDashboard?msg=' + htmlMsg);\n          });\n        } else {\n          htmlMsg = encodeURIComponent('Email existing, please enter a new one ...');\n          res.redirect('/admin/userDashboard?msg=' + htmlMsg);\n        }\n      });\n    });\n  });\n});\nrouter.get('/shoppingDashboard', (req, res) => {\n  var token = localStorage.getItem('authtoken');\n  console.log(\"token>>>\", token);\n\n  if (!token) {\n    res.redirect('/');\n  }\n\n  jwt.verify(token, config.secret, (err, decoded) => {\n    console.log(\"decoded ==> \", decoded);\n\n    if (err) {\n      res.redirect('/');\n    }\n\n    ;\n    User.findById(decoded.id, {\n      password: 0\n    }, (err, user) => {\n      if (err) {\n        res.redirect('/');\n      }\n\n      if (!user) {\n        res.redirect('/');\n      }\n\n      console.log(\"/shoppingDashboard : user ==> \", user);\n      Orderlist.find({}, (err, data) => {\n        if (err) res.status(500).send(err);else {\n          const now = Date.now();\n          let status;\n          let d0;\n          let sec;\n          const orders = data.map(order => {\n            d0 = Number(order.order_date);\n            sec = (now - d0) / 1000;\n            if (sec < 86400) status = \"In Progess\";else if (sec > 172800) status = \"Delivered\";else status = \"Dispatched\";\n            const d = new Date(d0).toLocaleDateString();\n            console.log(d);\n            order[\"order_date\"] = d;\n            order[\"order_status\"] = status;\n            return order;\n          });\n          console.log(\"/shoppingDashboard : orders ==> \", orders);\n          console.log(\"/shoppingDashboard : user ==> \", user);\n          res.render('shoppingDashboard.ejs', {\n            user,\n            data: orders,\n            msg: req.query.msg ? req.query.msg : ''\n          });\n        }\n      });\n    });\n  });\n}); // admin user dashboard\n\nrouter.get('/userDashboard', (req, res) => {\n  const token = localStorage.getItem('authtoken');\n  console.log(\"token>>>\", token);\n\n  if (!token) {\n    res.redirect('/');\n  }\n\n  jwt.verify(token, config.secret, (err, decoded) => {\n    if (err) res.redirect('/');\n    User.findById(decoded.id, {\n      password: 0\n    }, (err, user) => {\n      if (err) {\n        res.redirect('/');\n      }\n\n      if (!user) {\n        res.redirect('/');\n      }\n\n      console.log(\"user ==> \", user);\n      User.find({}, (err, data) => {\n        if (err) res.status(500).send(err);else {\n          res.render('userDashboard.ejs', {\n            user,\n            data,\n            msg: req.query.msg ? req.query.msg : ''\n          });\n        }\n      });\n    });\n  });\n});\nmodule.exports = router;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkFkbWluQ29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIkxvY2FsU3RvcmFnZSIsImxvY2FsU3RvcmFnZSIsImNvbmZpZyIsImp3dCIsImJjcnlwdCIsImJvZHlQYXJzZXIiLCJ1c2UiLCJ1cmxlbmNvZGVkIiwiZXh0ZW5kZWQiLCJqc29uIiwiVXNlciIsIk9yZGVybGlzdCIsImFwcCIsInNldCIsInN0YXRpYyIsIl9fZGlybmFtZSIsInNlc3Npb24iLCJzZWNyZXQiLCJyZXNhdmUiLCJzYXZlVW5pbml0aWFsaXplZCIsInBvc3QiLCJyZXEiLCJyZXMiLCJjb25zb2xlIiwibG9nIiwiYm9keSIsInRva2VuIiwiZ2V0SXRlbSIsInJlZGlyZWN0IiwidmVyaWZ5IiwiZXJyIiwiZGVjb2RlZCIsImZpbmRCeUlkIiwiaWQiLCJwYXNzd29yZCIsInVzZXIiLCJkIiwiRGF0ZSIsIm5vdyIsIm9yZGVyIiwib3JkZXJfZGF0ZSIsImNyZWF0ZSIsImRhdGEiLCJzdGF0dXMiLCJzZW5kIiwiaHRtbE1zZyIsImVuY29kZVVSSUNvbXBvbmVudCIsImZpbmRPbmUiLCJlbWFpbCIsImhhc2hlZFBhc3dvcmQiLCJoYXNoU3luYyIsIm5hbWUiLCJyb2xlIiwiZ2V0IiwiZmluZCIsImQwIiwic2VjIiwib3JkZXJzIiwibWFwIiwiTnVtYmVyIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwicmVuZGVyIiwibXNnIiwicXVlcnkiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUNBLE1BQU1DLE1BQU0sR0FBR0YsT0FBTyxDQUFDRyxNQUFSLEVBQWY7O0FBRUEsTUFBTUMsWUFBWSxHQUFHSCxPQUFPLENBQUMsbUJBQUQsQ0FBUCxDQUE2QkcsWUFBbEQ7O0FBQ0EsTUFBTUMsWUFBWSxHQUFHLElBQUlELFlBQUosQ0FBaUIsV0FBakIs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Q0FBQ0osR0FBRCxFQUFNSyxJQUFOLEtBQWU7QUFDdEQsVUFBSUwsR0FBSixFQUFTO0FBQUVSLFFBQUFBLEdBQUcsQ0FBQ00sUUFBSixDQUFhLEdBQWI7QUFBbUI7O0FBQzlCLFVBQUksQ0FBQ08sSUFBTCxFQUFXO0FBQUViLFFBQUFBLEdBQUcsQ0FBQ00sUUFBSixDQUFhLEdBQWI7QUFBbUI7O0FBQ2hDTCxNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxXQUFaLEVBQXlCVyxJQUF6QjtBQUVBekIsTUFBQUEsSUFBSSxDQUFDNEMsSUFBTCxDQUFVLEVBQVYsRUFBYyxDQUFDeEIsR0FBRCxFQUFNWSxJQUFOLEtBQWU7QUFDekIsWUFBSVosR0FBSixFQUFTUixHQUFHLENBQUNxQixNQUFKLENBQVcsR0FBWCxFQUFnQkMsSUFBaEIsQ0FBcUJkLEdBQXJCLEVBQVQsS0FDSztBQUNEUixVQUFBQSxHQUFHLENBQUN1QyxNQUFKLENBQVcsbUJBQVgsRUFBZ0M7QUFDNUIxQixZQUFBQSxJQUQ0QjtBQUU1Qk8sWUFBQUEsSUFGNEI7QUFHNUJvQixZQUFBQSxHQUFHLEVBQUV6QyxHQUFHLENBQUMwQyxLQUFKLENBQVVELEdBQVYsR0FBZ0J6QyxHQUFHLENBQUMwQyxLQUFKLENBQVVELEdBQTFCLEdBQWdDO0FBSFQsV0FBaEM7QUFLSDtBQUNKLE9BVEQ7QUFVSCxLQWZEO0FBZ0JILEdBbkJEO0FBb0JILENBNUJEO0FBOEJBRSxNQUFNLENBQUNDLE9BQVAsR0FBaUJuRSxNQUFqQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXEszMDAwNDRcXHByb2plY3RzXFxVc2VyQXV0aGVudGljYXRpb25BbmRTZWN1cml0eVxcYWRtaW5cXCIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcblxyXG5jb25zdCBMb2NhbFN0b3JhZ2UgPSByZXF1aXJlKCdub2RlLWxvY2Fsc3RvcmFnZScpLkxvY2FsU3RvcmFnZTtcclxuY29uc3QgbG9jYWxTdG9yYWdlID0gbmV3IExvY2FsU3RvcmFnZSgnLi9zY3JhdGNoJyk7XHJcblxyXG5jb25zdCBjb25maWcgPSByZXF1aXJlKCcuLi9jb25maWcuanMnKTtcclxuY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7XHJcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJyk7XHJcblxyXG5jb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTtcclxucm91dGVyLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XHJcbnJvdXRlci51c2UoYm9keVBhcnNlci5qc29uKCkpO1xyXG5cclxuY29uc3QgVXNlciA9IHJlcXVpcmUoJy4uL21vZGVscy9Vc2VyX21vZGVsJyk7XHJcbmNvbnN0IE9yZGVybGlzdCA9IHJlcXVpcmUoJy4uL21vZGVscy9PcmRlcl9tb2RlbCcpXHJcblxyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcbmFwcC5zZXQoJ3ZpZXcgZW5naW5lJywgJ2VqcycpO1xyXG5hcHAuc2V0KCd2aWV3cycsICcuL3ZpZXdzJyk7XHJcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMoX19kaXJuYW1lICsgJy9wdWJsaWMnKSk7XHJcblxyXG5jb25zdCBzZXNzaW9uID0gcmVxdWlyZSgnZXhwcmVzcy1zZXNzaW9uJyk7XHJcbnJvdXRlci51c2Uoc2Vzc2lvbih7IHNlY3JldDogJ2VkdXJla2FTZWNyZXQxJywgcmVzYXZlOiBmYWxzZSwgc2F2ZVVuaW5pdGlhbGl6ZWQ6IHRydWUgfSkpO1xyXG5cclxucm91dGVyLnBvc3QoJy9hZGRPbmVPcmRlcicsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCIvYWRkT25lT3JkZXIgOiByZXEuYm9keSA6IFwiLCByZXEuYm9keSlcclxuICAgIGNvbnN0IHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGh0b2tlbicpXHJcbiAgICBjb25zb2xlLmxvZyhcInRva2VuPj4+XCIsIHRva2VuKVxyXG5cclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICByZXMucmVkaXJlY3QoJy8nKVxyXG4gICAgfVxyXG4gICAgand0LnZlcmlmeSh0b2tlbiwgY29uZmlnLnNlY3JldCwgKGVyciwgZGVjb2RlZCkgPT4ge1xyXG5cclxuICAgICAgICBpZiAoZXJyKSByZXMucmVkaXJlY3QoJy8nKVxyXG4gICAgICAgIFVzZXIuZmluZEJ5SWQoZGVjb2RlZC5pZCwgeyBwYXNzd29yZDogMCB9LCAoZXJyLCB1c2VyKSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlcnIpIHsgcmVzLnJlZGlyZWN0KCcvJykgfVxyXG4gICAgICAgICAgICBpZiAoIXVzZXIpIHsgcmVzLnJlZGlyZWN0KCcvJykgfVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi9hZGRPbmVPcmRlciA6IHVzZXIgPT0+IFwiLCB1c2VyKVxyXG5cclxuICAgICAgICAgICAgY29uc3QgZCA9IERhdGUubm93KClcclxuICAgICAgICAgICAgY29uc3Qgb3JkZXIgPSB7IC4uLnJlcS5ib2R5LCBvcmRlcl9kYXRlOiBkIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCIvYWRkT25lT3JkZXIgOiBvcmRlciA9PiBcIiwgb3JkZXIpXHJcbiAgICAgICAgICAgIE9yZGVybGlzdC5jcmVhdGUoXHJcbiAgICAgICAgICAgICAgICBvcmRlclxyXG4gICAgICAgICAgICAgICAgLCAoZXJyLCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5zZW5kKCdUaGVyZSB3YXMgYSBwcm9ibGVtIHJlZ2lzdGVyaW5nIHVzZXInKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBJbnNlcnRlZCAuLi4gJHtkYXRhfSBgKVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGh0bWxNc2cgPSBlbmNvZGVVUklDb21wb25lbnQoJ0FkZGVkIE5ldyBPcmRlciBET05FICEnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXMucmVkaXJlY3QoJy9hZG1pbi9zaG9wcGluZ0Rhc2hib2FyZD9tc2c9JyArIGh0bWxNc2cpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0pXHJcblxyXG5cclxuLy8gYWRkIHVzZXJcclxucm91dGVyLnBvc3QoJy9hZGRVc2VyJywgKHJlcSwgcmVzKSA9PiB7XHJcblxyXG4gICAgY29uc3QgdG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYXV0aHRva2VuJylcclxuICAgIGNvbnNvbGUubG9nKFwidG9rZW4+Pj5cIiwgdG9rZW4pXHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgIH1cclxuICAgIGp3dC52ZXJpZnkodG9rZW4sIGNvbmZpZy5zZWNyZXQsIChlcnIsIGRlY29kZWQpID0+IHtcclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJlcy5yZWRpcmVjdCgnLycpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBVc2VyLmZpbmRCeUlkKGRlY29kZWQuaWQsIHsgcGFzc3dvcmQ6IDAgfSwgKGVyciwgdXNlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7IHJlcy5yZWRpcmVjdCgnLycpIH1cclxuICAgICAgICAgICAgaWYgKCF1c2VyKSB7IHJlcy5yZWRpcmVjdCgnLycpIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJhZG1pbi9hZGRVc2VyIDogdXNlciA9PT4gXCIsIHVzZXIpXHJcblxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIi9hZG1pbi9hZGRVc2VyIDogcmVxLmJvZHkgPT0+IFwiLCByZXEuYm9keSlcclxuICAgICAgICAgICAgVXNlci5maW5kT25lKHsgZW1haWw6IHJlcS5ib2R5LmVtYWlsIH0sIChlcnIsIHVzZXIpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCgnRXJyb3Igb24gdGhlIHNlcnZlci4nKTtcclxuICAgICAgICAgICAgICAgIGxldCBodG1sTXNnXHJcbiAgICAgICAgICAgICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBoYXNoZWRQYXN3b3JkID0gYmNyeXB0Lmhhc2hTeW5jKHJlcS5ib2R5LnBhc3N3b3JkLCA4KTtcclxuICAgICAgICAgICAgICAgICAgICBVc2VyLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJlcS5ib2R5Lm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiByZXEuYm9keS5lbWFpbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3dvcmQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGU6IHJlcS5ib2R5LnJvbGVcclxuICAgICAgICAgICAgICAgICAgICB9LCAoZXJyLCB1c2VyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiByZXMuc3RhdHVzKDUwMCkuc2VuZCgnVGhlcmUgd2FzIGEgcHJvYmxlbSByZWdpc3RlcmluZyB1c2VyJylcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbE1zZyA9IGVuY29kZVVSSUNvbXBvbmVudCgnQWRkZWQgTmV3IFVzZXIgRE9ORSAhJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3VzZXJEYXNoYm9hcmQ/bXNnPScgKyBodG1sTXNnKVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGh0bWxNc2cgPSBlbmNvZGVVUklDb21wb25lbnQoJ0VtYWlsIGV4aXN0aW5nLCBwbGVhc2UgZW50ZXIgYSBuZXcgb25lIC4uLicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcy5yZWRpcmVjdCgnL2FkbWluL3VzZXJEYXNoYm9hcmQ/bXNnPScgKyBodG1sTXNnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbnJvdXRlci5nZXQoJy9zaG9wcGluZ0Rhc2hib2FyZCcsIChyZXEsIHJlcykgPT4ge1xyXG4gICAgdmFyIHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2F1dGh0b2tlbicpXHJcbiAgICBjb25zb2xlLmxvZyhcInRva2VuPj4+XCIsIHRva2VuKVxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgIHJlcy5yZWRpcmVjdCgnLycpXHJcbiAgICB9XHJcbiAgICBqd3QudmVyaWZ5KHRva2VuLCBjb25maWcuc2VjcmV0LCAoZXJyLCBkZWNvZGVkKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJkZWNvZGVkID09PiBcIiwgZGVjb2RlZClcclxuICAgICAgICBpZiAoZXJyKSB7XHJcbiAgICAgICAgICAgIHJlcy5yZWRpcmVjdCgnLycpXHJcbiAgICAgICAgfTtcclxuICAgICAgICBVc2VyLmZpbmRCeUlkKGRlY29kZWQuaWQsIHsgcGFzc3dvcmQ6IDAgfSwgKGVyciwgdXNlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7IHJlcy5yZWRpcmVjdCgnLycpIH1cclxuICAgICAgICAgICAgaWYgKCF1c2VyKSB7IHJlcy5yZWRpcmVjdCgnLycpIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiL3Nob3BwaW5nRGFzaGJvYXJkIDogdXNlciA9PT4gXCIsIHVzZXIpXHJcblxyXG4gICAgICAgICAgICBPcmRlcmxpc3QuZmluZCh7fSwgKGVyciwgZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycikgcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyKVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCBzdGF0dXNcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZDBcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc2VjXHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3JkZXJzID0gZGF0YS5tYXAob3JkZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkMCA9IE51bWJlcihvcmRlci5vcmRlcl9kYXRlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWMgPSAobm93IC0gZDApIC8gMTAwMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VjIDwgODY0MDApIHN0YXR1cyA9IFwiSW4gUHJvZ2Vzc1wiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHNlYyA+IDE3MjgwMCkgc3RhdHVzID0gXCJEZWxpdmVyZWRcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHN0YXR1cyA9IFwiRGlzcGF0Y2hlZFwiXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBkID0gbmV3IERhdGUoZDApLnRvTG9jYWxlRGF0ZVN0cmluZygpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyW1wib3JkZXJfZGF0ZVwiXSA9IGRcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXJbXCJvcmRlcl9zdGF0dXNcIl0gPSBzdGF0dXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9yZGVyXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi9zaG9wcGluZ0Rhc2hib2FyZCA6IG9yZGVycyA9PT4gXCIsIG9yZGVycylcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIi9zaG9wcGluZ0Rhc2hib2FyZCA6IHVzZXIgPT0+IFwiLCB1c2VyKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXMucmVuZGVyKCdzaG9wcGluZ0Rhc2hib2FyZC5lanMnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IG9yZGVycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiByZXEucXVlcnkubXNnID8gcmVxLnF1ZXJ5Lm1zZyA6ICcnXHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59KVxyXG5cclxuLy8gYWRtaW4gdXNlciBkYXNoYm9hcmRcclxucm91dGVyLmdldCgnL3VzZXJEYXNoYm9hcmQnLCAocmVxLCByZXMpID0+IHtcclxuXHJcbiAgICBjb25zdCB0b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhdXRodG9rZW4nKVxyXG4gICAgY29uc29sZS5sb2coXCJ0b2tlbj4+PlwiLCB0b2tlbilcclxuXHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgIH1cclxuICAgIGp3dC52ZXJpZnkodG9rZW4sIGNvbmZpZy5zZWNyZXQsIChlcnIsIGRlY29kZWQpID0+IHtcclxuXHJcbiAgICAgICAgaWYgKGVycikgcmVzLnJlZGlyZWN0KCcvJylcclxuICAgICAgICBVc2VyLmZpbmRCeUlkKGRlY29kZWQuaWQsIHsgcGFzc3dvcmQ6IDAgfSwgKGVyciwgdXNlcikgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyKSB7IHJlcy5yZWRpcmVjdCgnLycpIH1cclxuICAgICAgICAgICAgaWYgKCF1c2VyKSB7IHJlcy5yZWRpcmVjdCgnLycpIH1cclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyID09PiBcIiwgdXNlcilcclxuXHJcbiAgICAgICAgICAgIFVzZXIuZmluZCh7fSwgKGVyciwgZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVycikgcmVzLnN0YXR1cyg1MDApLnNlbmQoZXJyKVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzLnJlbmRlcigndXNlckRhc2hib2FyZC5lanMnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zZzogcmVxLnF1ZXJ5Lm1zZyA/IHJlcS5xdWVyeS5tc2cgOiAnJ1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJvdXRlciJdfQ==",
    "map": {
      "version": 3,
      "sources": [
        "AdminController.js"
      ],
      "names": [
        "express",
        "require",
        "router",
        "Router",
        "LocalStorage",
        "localStorage",
        "config",
        "jwt",
        "bcrypt",
        "bodyParser",
        "use",
        "urlencoded",
        "extended",
        "json",
        "User",
        "Orderlist",
        "app",
        "set",
        "static",
        "__dirname",
        "session",
        "secret",
        "resave",
        "saveUninitialized",
        "post",
        "req",
        "res",
        "console",
        "log",
        "body",
        "token",
        "getItem",
        "redirect",
        "verify",
        "err",
        "decoded",
        "findById",
        "id",
        "password",
        "user",
        "d",
        "Date",
        "now",
        "order",
        "order_date",
        "create",
        "data",
        "status",
        "send",
        "htmlMsg",
        "encodeURIComponent",
        "findOne",
        "email",
        "hashedPasword",
        "hashSync",
        "name",
        "role",
        "get",
        "find",
        "d0",
        "sec",
        "orders",
        "map",
        "Number",
        "toLocaleDateString",
        "render",
        "msg",
        "query",
        "module",
        "exports"
      ],
      "mappings": "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",
      "sourceRoot": "C:\\Users\\K300044\\projects\\UserAuthenticationAndSecurity\\admin\\",
      "sourcesContent": [
        "const express = require('express');\r\nconst router = express.Router();\r\n\r\nconst LocalStorage = require('node-localstorage').LocalStorage;\r\nconst localStorage = new LocalStorage('./scratch');\r\n\r\nconst config = require('../config.js');\r\nconst jwt = require('jsonwebtoken');\r\nconst bcrypt = require('bcryptjs');\r\n\r\nconst bodyParser = require('body-parser');\r\nrouter.use(bodyParser.urlencoded({ extended: true }));\r\nrouter.use(bodyParser.json());\r\n\r\nconst User = require('../models/User_model');\r\nconst Orderlist = require('../models/Order_model')\r\n\r\nconst app = express();\r\napp.set('view engine', 'ejs');\r\napp.set('views', './views');\r\napp.use(express.static(__dirname + '/public'));\r\n\r\nconst session = require('express-session');\r\nrouter.use(session({ secret: 'edurekaSecret1', resave: false, saveUninitialized: true }));\r\n\r\nrouter.post('/addOneOrder', (req, res) => {\r\n    console.log(\"/addOneOrder : req.body : \", req.body)\r\n    const token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\", token)\r\n\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, (err, decoded) => {\r\n\r\n        if (err) res.redirect('/')\r\n        User.findById(decoded.id, { password: 0 }, (err, user) => {\r\n            if (err) { res.redirect('/') }\r\n            if (!user) { res.redirect('/') }\r\n            console.log(\"/addOneOrder : user ==> \", user)\r\n\r\n            const d = Date.now()\r\n            const order = { ...req.body, order_date: d }\r\n            console.log(\"/addOneOrder : order => \", order)\r\n            Orderlist.create(\r\n                order\r\n                , (err, data) => {\r\n                    if (err) return res.status(500).send('There was a problem registering user')\r\n                    console.log(`Inserted ... ${data} `)\r\n                    const htmlMsg = encodeURIComponent('Added New Order DONE !');\r\n                    res.redirect('/admin/shoppingDashboard?msg=' + htmlMsg)\r\n                })\r\n        });\r\n    });\r\n})\r\n\r\n\r\n// add user\r\nrouter.post('/addUser', (req, res) => {\r\n\r\n    const token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\", token)\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, (err, decoded) => {\r\n        if (err) {\r\n            res.redirect('/')\r\n        };\r\n        User.findById(decoded.id, { password: 0 }, (err, user) => {\r\n            if (err) { res.redirect('/') }\r\n            if (!user) { res.redirect('/') }\r\n            console.log(\"admin/addUser : user ==> \", user)\r\n\r\n            console.log(\"/admin/addUser : req.body ==> \", req.body)\r\n            User.findOne({ email: req.body.email }, (err, user) => {\r\n                if (err) return res.status(500).send('Error on the server.');\r\n                let htmlMsg\r\n                if (!user) {\r\n                    const hashedPasword = bcrypt.hashSync(req.body.password, 8);\r\n                    User.create({\r\n                        name: req.body.name,\r\n                        email: req.body.email,\r\n                        password: hashedPasword,\r\n                        role: req.body.role\r\n                    }, (err, user) => {\r\n                        if (err) return res.status(500).send('There was a problem registering user')\r\n                        htmlMsg = encodeURIComponent('Added New User DONE !');\r\n                        res.redirect('/admin/userDashboard?msg=' + htmlMsg)\r\n                    })\r\n                } else {\r\n                    htmlMsg = encodeURIComponent('Email existing, please enter a new one ...');\r\n                    res.redirect('/admin/userDashboard?msg=' + htmlMsg);\r\n                }\r\n            })\r\n        });\r\n    });\r\n});\r\n\r\nrouter.get('/shoppingDashboard', (req, res) => {\r\n    var token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\", token)\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, (err, decoded) => {\r\n        console.log(\"decoded ==> \", decoded)\r\n        if (err) {\r\n            res.redirect('/')\r\n        };\r\n        User.findById(decoded.id, { password: 0 }, (err, user) => {\r\n            if (err) { res.redirect('/') }\r\n            if (!user) { res.redirect('/') }\r\n\r\n            console.log(\"/shoppingDashboard : user ==> \", user)\r\n\r\n            Orderlist.find({}, (err, data) => {\r\n                if (err) res.status(500).send(err)\r\n                else {\r\n                    const now = Date.now()\r\n                    let status\r\n                    let d0\r\n                    let sec\r\n                    const orders = data.map(order => {\r\n                        d0 = Number(order.order_date)\r\n                        sec = (now - d0) / 1000\r\n                        if (sec < 86400) status = \"In Progess\"\r\n                        else if (sec > 172800) status = \"Delivered\"\r\n                        else status = \"Dispatched\"\r\n\r\n                        const d = new Date(d0).toLocaleDateString()\r\n                        console.log(d)\r\n                        order[\"order_date\"] = d\r\n                        order[\"order_status\"] = status\r\n                        return order\r\n                    })\r\n                    console.log(\"/shoppingDashboard : orders ==> \", orders)\r\n                    console.log(\"/shoppingDashboard : user ==> \", user)\r\n\r\n                    res.render('shoppingDashboard.ejs', {\r\n                        user,\r\n                        data: orders,\r\n                        msg: req.query.msg ? req.query.msg : ''\r\n                    })\r\n                }\r\n            })\r\n        });\r\n    });\r\n})\r\n\r\n// admin user dashboard\r\nrouter.get('/userDashboard', (req, res) => {\r\n\r\n    const token = localStorage.getItem('authtoken')\r\n    console.log(\"token>>>\", token)\r\n\r\n    if (!token) {\r\n        res.redirect('/')\r\n    }\r\n    jwt.verify(token, config.secret, (err, decoded) => {\r\n\r\n        if (err) res.redirect('/')\r\n        User.findById(decoded.id, { password: 0 }, (err, user) => {\r\n            if (err) { res.redirect('/') }\r\n            if (!user) { res.redirect('/') }\r\n            console.log(\"user ==> \", user)\r\n\r\n            User.find({}, (err, data) => {\r\n                if (err) res.status(500).send(err)\r\n                else {\r\n                    res.render('userDashboard.ejs', {\r\n                        user,\r\n                        data,\r\n                        msg: req.query.msg ? req.query.msg : ''\r\n                    })\r\n                }\r\n            })\r\n        });\r\n    });\r\n});\r\n\r\nmodule.exports = router"
      ]
    },
    "sourceType": "module",
    "mtime": 1613918759740
  }
}